[
    {
        "id": "84f9df6667326f98",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c7d9c1b1f0a6a111",
        "type": "tab",
        "label": "\bChart from DB",
        "disabled": false,
        "info": ""
    },
    {
        "id": "flow_all",
        "type": "tab",
        "label": "CSV Table & Download",
        "disabled": false,
        "info": ""
    },
    {
        "id": "tab_mjpg_sched",
        "type": "tab",
        "label": "MJPG Daily Restart",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8e3d9986d6facbaa",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Only for test",
        "style": {
            "label": true
        },
        "nodes": [
            "7d94ba1bde198563",
            "352c9682952738a1",
            "2aac44c159923b07"
        ],
        "x": 24,
        "y": 2379,
        "w": 602,
        "h": 82
    },
    {
        "id": "db7c14177e93d281",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Weather",
        "style": {
            "label": true
        },
        "nodes": [
            "69a30e0444bb669f",
            "0c616ffe17850d92",
            "bf53ee007fe03cd5",
            "f5fd1707a82fa48e",
            "4cfd8f2b53cc451d",
            "293430283ab23a41",
            "b89586cab333bd2e",
            "c2ade38cad9171d1",
            "3d7d2f065fdf2586",
            "d586cb3f7734c89b",
            "86d402bb852608aa",
            "5d2cb7466e104cc6",
            "89e1ca49952cbc39",
            "38793410c1318250",
            "db41d8aaae19562a",
            "10e24fbb56540788",
            "54a303cc73b75606",
            "134c43948fc1ed53",
            "84304c396249d138",
            "5b23b8e421363f09",
            "a0a515737d2c4544"
        ],
        "x": 34,
        "y": 2479,
        "w": 1152,
        "h": 442
    },
    {
        "id": "5d6e724936f68d35",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Lighting",
        "style": {
            "label": true
        },
        "nodes": [
            "b502edc7e45ce251",
            "3ea78dedeaaf4c6f",
            "209c9e40e526fa6c",
            "ebec3f11f763b5eb",
            "a880f70db10cfa4e",
            "407bba549c9d5227"
        ],
        "x": 34,
        "y": 1739,
        "w": 772,
        "h": 202
    },
    {
        "id": "17b6e50d0d55a4f0",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Temperature and Humidity data  by RS485 & Modbus",
        "style": {
            "label": true
        },
        "nodes": [
            "1ef22f386c9aec37",
            "3e0d3da6b07b2dc6",
            "27b42466e6ba6223",
            "218ff43bca981fe9",
            "44df4d9894a065c8",
            "b9d92e30fe8245b6",
            "6f78720a8e847149",
            "1f0406ae79e0ddfb",
            "edbaee0256ec938f",
            "9c2f5d5a308616e6",
            "8abaa57bae76a3db",
            "00d442aea9bc0def",
            "43781b4d61de441e",
            "9d04753ceb6008d4",
            "4eac55c97bf5ac4b",
            "d3d5c208297b5bcb",
            "ce91a081135d3653",
            "a81d2b73695ec428",
            "f033277dce8c9fc3"
        ],
        "x": 4,
        "y": -21,
        "w": 1042,
        "h": 582
    },
    {
        "id": "466f7742a246e74a",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Air conditioning",
        "style": {
            "label": true
        },
        "nodes": [
            "bf3cffe8b8bf90c4",
            "e5c0943a8969389f",
            "4e27f9d174bd08fd",
            "a807676ee13f76fc",
            "7b17019d9694c425",
            "167efd5b81c44cdc",
            "3cba5f141191ab45",
            "249836baa17d7698",
            "43877a5160c9b295",
            "3e851f1eaea09d75",
            "4a9a0ff04207202d",
            "0834272c61fa1d91",
            "53e4c030b80e8a42",
            "1d50e0dd0e72e657",
            "893d48d19cc2c365",
            "91b2109638828671",
            "dca8353ba4f4c218",
            "9527ba84ddcf42d2",
            "29ecb140bf1f8d74"
        ],
        "x": 34,
        "y": 1319,
        "w": 1042,
        "h": 442
    },
    {
        "id": "912ed1b86333869f",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Nutrient solution input control",
        "style": {
            "label": true
        },
        "nodes": [
            "inp_a_ml",
            "fn_a_save_ml",
            "txt_a_current",
            "btn_a_run",
            "fn_a_run_ml",
            "gpio25_out",
            "txt_a_last",
            "file_a_csv",
            "inj_a_header",
            "fn_a_header_guard",
            "e10e368c452dd270",
            "2b753df6afdd64b6",
            "eaae89fb0638005f",
            "a87b84159b60d57f",
            "7284d4e9e0010867",
            "1a838d3ee158ae54",
            "6044e01bb19ae4bc",
            "6dddb568535969eb",
            "7715901eb0e673bd",
            "f97336f95369f779"
        ],
        "x": 34,
        "y": 2939,
        "w": 1632,
        "h": 462
    },
    {
        "id": "915bc3b1ca228f03",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 Nutrient solution control",
        "style": {
            "label": true
        },
        "nodes": [
            "577253202c73b09c",
            "3725b711ea5e2772",
            "839c019b8d38b1ce",
            "2338e23a2b4a1061",
            "7164aeb31763ab09",
            "53bfde506c6ea7dd"
        ],
        "x": 34,
        "y": 2099,
        "w": 812,
        "h": 202
    },
    {
        "id": "e8ce93fc01bd7af9",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Solution condition (EC, pH, temp)  data by RS485 & Modbus",
        "style": {
            "label": true
        },
        "nodes": [
            "1753d4563875309b",
            "1aa3bbe8afdc012d",
            "7e26ce5601b49a9c",
            "27b92651c8adebe9",
            "13c6bea38d428920",
            "4a02d1b9cf1788c8",
            "a5e1c7bdeb69b644",
            "11865337c5295aac",
            "7af2caa5030f659e",
            "f66d5cc3cb3342a2",
            "bb98eb9ce85f5dcf",
            "b91f54bc77701ab9",
            "c8989cc1bcccdf49",
            "82f348c6dba2eac2",
            "5641f5451274dc21",
            "279ca9bacb60e6fc",
            "a04387180383435c",
            "9a4c7a02cad47b84",
            "b221c02018673863"
        ],
        "x": 24,
        "y": 579,
        "w": 1102,
        "h": 662
    },
    {
        "id": "3eaca329610704eb",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Get Solution condition (EC, pH, temp) data by RS485 & serial",
        "style": {
            "label": true
        },
        "nodes": [
            "1caf8a5c5e3446a5",
            "25a1fc18f884cf3a",
            "12a11f4918b20262",
            "ada6e5f91605f50b",
            "ded04047b201eda5",
            "3f103b9815f86dd4",
            "27c51267c346f89a",
            "882bd2a1db484c7a",
            "83ef16bf59648dba",
            "523fb7d4146c728e",
            "19575127be6263da",
            "7c25ba5dd16a36b6",
            "2c23a9c69bfd5964",
            "bed3ea5061f3aa42",
            "55c7596a34b371e7",
            "1b55bb39740ed3db",
            "10a137bf882b5184",
            "1236be8eabaf376f",
            "23d54e14bb05b234"
        ],
        "x": 1144,
        "y": 579,
        "w": 1122,
        "h": 662
    },
    {
        "id": "ad1743f076448914",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Lighting",
        "style": {
            "label": true
        },
        "nodes": [
            "7a499e2de11fb75a",
            "e08d25bb4b05e048",
            "0b9b9d5aae2018ff",
            "ef29638c34485786",
            "a1e65c136a4faf8e",
            "0fcda68765a6a783"
        ],
        "x": 914,
        "y": 1879,
        "w": 772,
        "h": 202
    },
    {
        "id": "978a9587f7a84adc",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Nutrient solution control",
        "style": {
            "label": true
        },
        "nodes": [
            "4f385e73050961e1",
            "f15e7c328f5d7fd4",
            "63e650f897ae7cfe",
            "3aa9a7e96d4cfe09",
            "e320eb5d6e113614",
            "ae4b9c4ddf882e9b"
        ],
        "x": 894,
        "y": 2259,
        "w": 812,
        "h": 202
    },
    {
        "id": "b1927e4ba08d43c4",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Nutrient solution input control",
        "style": {
            "label": true
        },
        "nodes": [
            "032638cc6c5fc9f2",
            "742c215264b52d5d",
            "66ddab9642e34173",
            "e4a0abcae8745f5d",
            "80cc8c87a9dcdff5",
            "c7fe5d35e20589ec",
            "e0b97cfcaafbe7a8",
            "ce77e02c54e5281c",
            "d77f241745577d87",
            "f7516acac2b29596",
            "abf0f3cd0103cc31",
            "083acd90c241f25d",
            "972eec39af78be9a",
            "ada5f246a3285a35",
            "67dfe99f35a05924",
            "21fc1765b77482f9",
            "f37eddb8c684e4ec",
            "8bfc716cf46fb70d",
            "d4e056cc41c01da1",
            "78091ee38cd1e0cc"
        ],
        "x": 1734,
        "y": 2939,
        "w": 1592,
        "h": 482
    },
    {
        "id": "7e05584f07adae7b",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Dist 2 Solution state",
        "style": {
            "label": true
        },
        "nodes": [
            "84915ae7f5c9b3c6",
            "7b2f5b8520aa74d8",
            "6104d3b154bae62a",
            "10de8cbe4af04315",
            "66dddb17279fa4ea",
            "2ca82c801cc78dcf",
            "7bcaa443ae916920",
            "c17e5970c5cc707c",
            "6b044a38741310f6",
            "413edac3ab2c73bf"
        ],
        "x": 34,
        "y": 319,
        "w": 1412,
        "h": 222
    },
    {
        "id": "be6e98c17615581b",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Dist 1 Solution state",
        "style": {
            "label": true
        },
        "nodes": [
            "9a7f2b6b84f6a001",
            "2c1d3e4f5a6b7c80",
            "3d2e4f5a6b7c8d90",
            "4e3f5a6b7c8d9ea0",
            "fc506592c792073d",
            "2b11787c0f4b97a0",
            "fcc61e3763443285",
            "9e58a61289d8c37b",
            "b5943a1f7cf1632b",
            "8d576cf243516148"
        ],
        "x": 34,
        "y": 39,
        "w": 1412,
        "h": 222
    },
    {
        "id": "89c2f9d79f818571",
        "type": "group",
        "z": "c7d9c1b1f0a6a111",
        "name": "Room condition",
        "style": {
            "label": true
        },
        "nodes": [
            "9d672b31c0fdbdf0",
            "11c49a6273f636d3",
            "efb0d37433575254",
            "e7fd9e961e86b1b1",
            "74989654888b2172",
            "61d28f90c35a0e04",
            "c3284b9db2edcac0",
            "b4b069056ce7fe97",
            "e9bba788651eb3d4",
            "715c885393e8b131"
        ],
        "x": 14,
        "y": 599,
        "w": 1372,
        "h": 202
    },
    {
        "id": "89edff7748839507",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 1 EC pH Auto control",
        "style": {
            "label": true
        },
        "nodes": [
            "ui_auto_switch",
            "fn_set_auto_flag",
            "b17d8c4a3bca04cb",
            "7cf8ec733dff273c",
            "57f723a2128c43d5",
            "59b0ff71adae82a7",
            "ccf0ccf62190c269",
            "977cea532afc089a",
            "7dcc7bbc6be0b9f7"
        ],
        "x": 34,
        "y": 3419,
        "w": 1172,
        "h": 242
    },
    {
        "id": "121d5ec0629dc581",
        "type": "group",
        "z": "84f9df6667326f98",
        "name": "Dist 2 EC pH Auto control",
        "style": {
            "label": true
        },
        "nodes": [
            "8f09733d80d00645",
            "13cb5d10e2e2abf5",
            "d97d2f46df0c69b4",
            "386503bda4f5c254",
            "11668b201f94f5a6",
            "d172c8ca1a88f8c0",
            "97a7ee0f561696f6",
            "46aa6ebe59e28fc0"
        ],
        "x": 1654,
        "y": 3469,
        "w": 1352,
        "h": 172
    },
    {
        "id": "8446b5ed352ca2d8",
        "type": "group",
        "z": "flow_all",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "adc9839917f22d12",
            "944e216c6a520e54",
            "a22b223becb16273",
            "197112b240ad2134",
            "2588aa26c880e550",
            "90d2176c35e8e7cb",
            "a0eaac3edf8af92e",
            "96aa85f9b22bce2a",
            "14035e35d8173d54",
            "10b47748db311969",
            "1d859b1f08e16750",
            "5492ffead4d707b1",
            "5d24488e666ee37c",
            "9a6aa10181469ac7",
            "ad92971d35a3f9b1",
            "6db4030be30fbdb9",
            "716fa25ba9db853a",
            "cae69a4b087570ee",
            "d4739939fd8e23db",
            "b125209d3d41004e",
            "f5a6a15636c2ae8a",
            "7dc725beeaba75fc",
            "6897d08c634f30b3"
        ],
        "x": 94,
        "y": 59,
        "w": 1152,
        "h": 462
    },
    {
        "id": "f8142c59ee10a26e",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "CJA Skyfarms Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "YYYY/MM/DD",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "a18fb94af755fd24",
        "type": "ui_tab",
        "name": "CJA Skyfarms Dashboard",
        "icon": "home",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "c888f82b8cc4653a",
        "type": "ui_group",
        "name": "Room Condition",
        "tab": "a18fb94af755fd24",
        "order": 1,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "049242d2ef9a58f0",
        "type": "ui_group",
        "name": "Humidity",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c6a28c1ed72e1675",
        "type": "ui_group",
        "name": "Camera",
        "tab": "a18fb94af755fd24",
        "order": 5,
        "disp": false,
        "width": 7,
        "collapse": false,
        "className": ""
    },
    {
        "id": "1de49aac0f0db196",
        "type": "ui_group",
        "name": "Weather",
        "tab": "",
        "order": 8,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_grp1",
        "type": "ui_group",
        "name": "Download",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_tab_dashboard",
        "type": "ui_tab",
        "name": "Database",
        "icon": "file_download",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ui_grp_table",
        "type": "ui_group",
        "name": "Database",
        "tab": "ui_tab_dashboard",
        "order": 1,
        "disp": true,
        "width": 12,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c5fb925fb5ca84e9",
        "type": "ui_group",
        "name": "Dist 1. Solution Condition",
        "tab": "a18fb94af755fd24",
        "order": 2,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "55294fa623e898e0",
        "type": "ui_group",
        "name": "pH",
        "tab": "",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "ui_grp_ctrl",
        "type": "ui_group",
        "name": "Controls",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "9a12b08656165df4",
        "type": "ui_group",
        "name": "Solution Temperature",
        "tab": "",
        "order": 5,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "4ea62e075d022552",
        "type": "ui_group",
        "name": "CO2",
        "tab": "",
        "order": 10,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "aa578847983587e6",
        "type": "ui_group",
        "name": "Dist 2. Solution Condition",
        "tab": "a18fb94af755fd24",
        "order": 3,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "f870e65464d4e015",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 7,
        "height": 1
    },
    {
        "id": "db6402d6f3215edd",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 7,
        "height": 1
    },
    {
        "id": "8e06d2030eb18082",
        "type": "ui_tab",
        "name": "Controller",
        "icon": "\bphone",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "e3eac795c3a63651",
        "type": "ui_group",
        "name": "Dist 2. Controller",
        "tab": "8e06d2030eb18082",
        "order": 3,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "f325796ebb721579",
        "type": "ui_group",
        "name": "Dist 1. Controller",
        "tab": "8e06d2030eb18082",
        "order": 1,
        "disp": true,
        "width": 8,
        "collapse": false,
        "className": ""
    },
    {
        "id": "b2e3d4c5f6a7b890",
        "type": "ui_group",
        "name": "Dist 1 (Last 7 days)",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "18",
        "collapse": false
    },
    {
        "id": "chart_group",
        "type": "ui_group",
        "name": "Room Condition (CSV)",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": 12
    },
    {
        "id": "754652e575651e31",
        "type": "remote-config",
        "name": "CJA Skyfarms Dashboard",
        "host": "192.168.5.145",
        "protocol": "https",
        "port": "1880",
        "baseurl": "/ui",
        "instancehash": "c60xrzt1sywo8yr5osssyrkf0yo9sr1vi9gval2usgptvzwc8xbbpxgfiitimpxt",
        "server": "nodered05.remote-red.com",
        "region": "sg"
    },
    {
        "id": "bbb354e7c724e7d9",
        "type": "remote-config",
        "name": "Node-RED UI",
        "host": "localhost",
        "protocol": "https",
        "port": "1880",
        "baseurl": "/ui",
        "instancehash": "g9u7xzwtmi6h7dp18uvckhwu6hkknujcv517oyyijq95gnneuezbckm2locnb0ie",
        "server": "nodered05.remote-red.com",
        "region": "sg"
    },
    {
        "id": "a812be762c63db42",
        "type": "ui_spacer",
        "z": "84f9df6667326f98",
        "name": "spacer",
        "group": "f325796ebb721579",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "8a2dbce163db26b4",
        "type": "sqlitedb",
        "db": "/home/cja/Work/cja-skyfarms-project/data/data.db",
        "mode": "RO"
    },
    {
        "id": "b4b6d0cdbd70071a",
        "type": "sqlitedb",
        "db": "/home/cja/Work/cja-skyfarms-project/data/data.db",
        "mode": "RWC"
    },
    {
        "id": "sql_db_cfg",
        "type": "sqlitedb",
        "db": "/home/cja/Work/cja-skyfarms-project/data/data.db",
        "mode": "RWC"
    },
    {
        "id": "1ef22f386c9aec37",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 100,
        "wires": [
            [
                "3e0d3da6b07b2dc6"
            ]
        ]
    },
    {
        "id": "3e0d3da6b07b2dc6",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Room_condition",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/room_condition.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 320,
        "y": 100,
        "wires": [
            [
                "27b42466e6ba6223"
            ]
        ]
    },
    {
        "id": "27b42466e6ba6223",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 510,
        "y": 100,
        "wires": [
            [
                "218ff43bca981fe9",
                "44df4d9894a065c8",
                "b9d92e30fe8245b6",
                "d3d5c208297b5bcb",
                "9c2f5d5a308616e6"
            ]
        ]
    },
    {
        "id": "218ff43bca981fe9",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 100,
        "wires": [
            [
                "edbaee0256ec938f"
            ]
        ]
    },
    {
        "id": "44df4d9894a065c8",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 160,
        "wires": [
            [
                "6f78720a8e847149",
                "8abaa57bae76a3db",
                "43781b4d61de441e"
            ]
        ]
    },
    {
        "id": "b9d92e30fe8245b6",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Humidity",
        "rules": [
            {
                "t": "move",
                "p": "payload.humidity",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 300,
        "wires": [
            [
                "1f0406ae79e0ddfb",
                "00d442aea9bc0def",
                "9d04753ceb6008d4"
            ]
        ]
    },
    {
        "id": "6f78720a8e847149",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 160,
        "wires": []
    },
    {
        "id": "1f0406ae79e0ddfb",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 3",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 320,
        "wires": []
    },
    {
        "id": "edbaee0256ec938f",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 880,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "9c2f5d5a308616e6",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 20,
        "wires": []
    },
    {
        "id": "8abaa57bae76a3db",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Temperature",
        "label": "℃",
        "format": "{{value}}",
        "min": "10",
        "max": "40",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "23",
        "seg2": "30",
        "diff": false,
        "className": "",
        "x": 930,
        "y": 220,
        "wires": []
    },
    {
        "id": "7d94ba1bde198563",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 2420,
        "wires": [
            [
                "2aac44c159923b07"
            ]
        ]
    },
    {
        "id": "352c9682952738a1",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 520,
        "y": 2420,
        "wires": []
    },
    {
        "id": "2aac44c159923b07",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "8e3d9986d6facbaa",
        "name": "Relay_test",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/test_code/relay_test.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 330,
        "y": 2420,
        "wires": [
            [
                "352c9682952738a1"
            ]
        ]
    },
    {
        "id": "00d442aea9bc0def",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "wave",
        "title": "Humidity",
        "label": "%",
        "format": "{{value}}",
        "min": "30",
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "diff": false,
        "className": "",
        "x": 920,
        "y": 360,
        "wires": []
    },
    {
        "id": "43781b4d61de441e",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 22,
        "width": 6,
        "height": 5,
        "label": "Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "10",
        "ymax": "40",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 930,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "9d04753ceb6008d4",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 23,
        "width": 6,
        "height": 5,
        "label": "Humidity",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "20",
        "ymax": "100",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 920,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "4eac55c97bf5ac4b",
        "type": "comment",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "Read temp, humi data and show on the dashboard",
        "info": "",
        "x": 230,
        "y": 60,
        "wires": []
    },
    {
        "id": "3e851f1eaea09d75",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "",
        "label": "Mini Fan",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 5,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "Node-Red Dashboard Custom CSS",
        "x": 340,
        "y": 1380,
        "wires": [
            [
                "1d50e0dd0e72e657",
                "893d48d19cc2c365"
            ]
        ]
    },
    {
        "id": "167efd5b81c44cdc",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "group": "f325796ebb721579",
        "order": 4,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Air conditioning",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 140,
        "y": 1420,
        "wires": []
    },
    {
        "id": "43877a5160c9b295",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "GPIO: 13",
        "pin": "13",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 960,
        "y": 1440,
        "wires": []
    },
    {
        "id": "3cba5f141191ab45",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "",
        "label": "Circulator",
        "tooltip": "",
        "group": "",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 340,
        "y": 1500,
        "wires": [
            [
                "a807676ee13f76fc",
                "4e27f9d174bd08fd"
            ]
        ]
    },
    {
        "id": "249836baa17d7698",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "GPIO: 16",
        "pin": "16",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 940,
        "y": 1580,
        "wires": []
    },
    {
        "id": "69a30e0444bb669f",
        "type": "inject",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 2600,
        "wires": [
            [
                "0c616ffe17850d92"
            ]
        ]
    },
    {
        "id": "0c616ffe17850d92",
        "type": "http request",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "openweather data request",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "https://api.openweathermap.org/data/2.5/weather?id=1837055&appid=879d48a29fd4ed55df4a26799ecd2344",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 350,
        "y": 2600,
        "wires": [
            [
                "bf53ee007fe03cd5",
                "f5fd1707a82fa48e"
            ]
        ]
    },
    {
        "id": "bf53ee007fe03cd5",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "msg.payload",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 2520,
        "wires": []
    },
    {
        "id": "f5fd1707a82fa48e",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Weather data parsing",
        "func": "// Convert Kelvin to Celsius\nfunction toCelsius(kelvin) {\n    return parseFloat((kelvin - 273.15).toFixed(2));\n}\n\n// Convert wind degrees to 8-point compass direction\nfunction windDirection8(deg) {\n    const dirs = [\"N\", \"NE\", \"E\", \"NE\", \"N\", \"NW\", \"W\", \"NW\"];\n    return dirs[Math.round(deg / 45) % 8];\n}\n\n// Get rain info\nlet rainAmount = 0;\nif (msg.payload.rain && msg.payload.rain[\"1h\"]) {\n    rainAmount = msg.payload.rain[\"1h\"];\n}\n\n// Get probability of precipitation\nlet pop = msg.payload.pop !== undefined ? Math.round(msg.payload.pop * 100) : (rainAmount > 0 ? 100 : 0);\n\n// Format timestamp\nlet time = new Date(msg.payload.dt * 1000).toLocaleString('en-KR');\n\n// Extract and convert values\nlet temp = toCelsius(msg.payload.main.temp);\nlet feels_like = toCelsius(msg.payload.main.feels_like);\nlet humidity = msg.payload.main.humidity;\nlet wind_speed = parseFloat(msg.payload.wind.speed.toFixed(2));\nlet wind_deg = msg.payload.wind.deg;\nlet wind_dir = windDirection8(wind_deg);\n\nmsg.payload = {\n    time: time,\n    temp: temp,\n    feels_like: feels_like,\n    humidity: humidity,\n    wind_speed: wind_speed,\n    wind_deg: wind_deg,\n    wind_direction: wind_dir,\n    rain_mm_per_hour: rainAmount,\n    pop_percent: pop\n};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 600,
        "y": 2600,
        "wires": [
            [
                "4cfd8f2b53cc451d",
                "293430283ab23a41",
                "b89586cab333bd2e",
                "c2ade38cad9171d1",
                "3d7d2f065fdf2586",
                "d586cb3f7734c89b",
                "86d402bb852608aa",
                "5d2cb7466e104cc6",
                "89e1ca49952cbc39"
            ]
        ]
    },
    {
        "id": "4cfd8f2b53cc451d",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "msg.payload",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 2520,
        "wires": []
    },
    {
        "id": "293430283ab23a41",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Temperature_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.temp",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 2640,
        "wires": [
            [
                "134c43948fc1ed53"
            ]
        ]
    },
    {
        "id": "b89586cab333bd2e",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Feel_temp_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.feels_like",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2680,
        "wires": [
            [
                "db41d8aaae19562a"
            ]
        ]
    },
    {
        "id": "c2ade38cad9171d1",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "Humi_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.humidity",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 2720,
        "wires": [
            [
                "10e24fbb56540788"
            ]
        ]
    },
    {
        "id": "3d7d2f065fdf2586",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "wind_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.wind_speed",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 2760,
        "wires": [
            [
                "54a303cc73b75606"
            ]
        ]
    },
    {
        "id": "d586cb3f7734c89b",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "wind_dirct_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.wind_direction",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2800,
        "wires": [
            [
                "84304c396249d138"
            ]
        ]
    },
    {
        "id": "86d402bb852608aa",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "precipitation_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.rain_mm_per_hour",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 2880,
        "wires": [
            [
                "a0a515737d2c4544"
            ]
        ]
    },
    {
        "id": "5d2cb7466e104cc6",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "precipitation_per_out",
        "rules": [
            {
                "t": "move",
                "p": "payload.pop_percent",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 840,
        "y": 2840,
        "wires": [
            [
                "5b23b8e421363f09"
            ]
        ]
    },
    {
        "id": "89e1ca49952cbc39",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "name": "date",
        "rules": [
            {
                "t": "move",
                "p": "payload.time",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 790,
        "y": 2600,
        "wires": [
            [
                "38793410c1318250"
            ]
        ]
    },
    {
        "id": "38793410c1318250",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1030,
        "y": 2600,
        "wires": []
    },
    {
        "id": "db41d8aaae19562a",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Feel Like",
        "format": "{{msg.payload}} ℃",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2680,
        "wires": []
    },
    {
        "id": "10e24fbb56540788",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Humidity",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2720,
        "wires": []
    },
    {
        "id": "54a303cc73b75606",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Wind Speed",
        "format": "{{msg.payload}} m/s",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1050,
        "y": 2760,
        "wires": []
    },
    {
        "id": "134c43948fc1ed53",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Air Temperature",
        "format": "{{msg.payload}} ℃",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1060,
        "y": 2640,
        "wires": []
    },
    {
        "id": "84304c396249d138",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Wind Direction",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1060,
        "y": 2800,
        "wires": []
    },
    {
        "id": "5b23b8e421363f09",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Rainfall Probablility",
        "format": "{{msg.payload}} %",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1070,
        "y": 2840,
        "wires": []
    },
    {
        "id": "a0a515737d2c4544",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "db7c14177e93d281",
        "group": "1de49aac0f0db196",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Rainfall",
        "format": "{{msg.payload}} mm/h",
        "layout": "row-spread",
        "className": "",
        "style": true,
        "font": "",
        "fontSize": "20",
        "color": "#ffffff",
        "x": 1040,
        "y": 2880,
        "wires": []
    },
    {
        "id": "31b42f4d9be9eb00",
        "type": "ui_template",
        "z": "84f9df6667326f98",
        "group": "c6a28c1ed72e1675",
        "name": "Streaming the mjpg",
        "order": 1,
        "width": 7,
        "height": 6,
        "format": "<div style=\"text-align: center;\">\n    <h3>Live Stream (Preview)</h3>\n\n    <!-- 축소된 화면 크기에 맞춰 부모 div 높이도 조정 -->\n    <div style=\"width: 320px; height: 180px; overflow: hidden; display: inline-block;\">\n        <div style=\"transform: scale(0.25); transform-origin: top left;\">\n            <iframe src=\"http://1.217.132.157:8080/?action=stream\" width=\"1280\" height=\"720\" frameborder=\"0\"\n                style=\"border:1px solid #ccc;\">\n            </iframe>\n        </div>\n    </div>\n\n    <!-- 전체화면 버튼 - 영상 바로 밑에 위치 -->\n    <div style=\"margin-top: 6px;\">\n        <a href=\"http://1.217.132.157:8080/?action=stream\" target=\"_blank\">\n            <button style=\"padding: 6px 12px;\">Full screen</button>\n        </a>\n    </div>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 130,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "13c6bea38d428920",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 470,
        "y": 680,
        "wires": [
            [
                "4a02d1b9cf1788c8",
                "a5e1c7bdeb69b644",
                "11865337c5295aac",
                "a04387180383435c",
                "1753d4563875309b"
            ]
        ]
    },
    {
        "id": "4a02d1b9cf1788c8",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 680,
        "wires": [
            [
                "bb98eb9ce85f5dcf"
            ]
        ]
    },
    {
        "id": "a5e1c7bdeb69b644",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "EC",
        "rules": [
            {
                "t": "move",
                "p": "payload.EC",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 740,
        "wires": [
            [
                "7af2caa5030f659e",
                "c8989cc1bcccdf49",
                "5641f5451274dc21"
            ]
        ]
    },
    {
        "id": "11865337c5295aac",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "pH",
        "rules": [
            {
                "t": "move",
                "p": "payload.pH",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 940,
        "wires": [
            [
                "f66d5cc3cb3342a2",
                "82f348c6dba2eac2",
                "279ca9bacb60e6fc"
            ]
        ]
    },
    {
        "id": "7af2caa5030f659e",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 EC",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 740,
        "wires": []
    },
    {
        "id": "f66d5cc3cb3342a2",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 pH",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 940,
        "wires": []
    },
    {
        "id": "bb98eb9ce85f5dcf",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 680,
        "wires": [
            [
                "b91f54bc77701ab9"
            ]
        ]
    },
    {
        "id": "b91f54bc77701ab9",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "debug 8",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1020,
        "y": 680,
        "wires": []
    },
    {
        "id": "c8989cc1bcccdf49",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "EC",
        "label": "mS/cm",
        "format": "{{value}}",
        "min": "0",
        "max": "3",
        "colors": [
            "#00b500",
            "#00b500",
            "#b50000"
        ],
        "seg1": "",
        "seg2": "1.8",
        "diff": false,
        "className": "",
        "x": 870,
        "y": 800,
        "wires": []
    },
    {
        "id": "82f348c6dba2eac2",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "pH",
        "label": "",
        "format": "{{value}}",
        "min": "0",
        "max": "10",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "5.5",
        "seg2": "7",
        "diff": false,
        "className": "",
        "x": 870,
        "y": 1000,
        "wires": []
    },
    {
        "id": "5641f5451274dc21",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 22,
        "width": 6,
        "height": 5,
        "label": "EC",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "3",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 870,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "279ca9bacb60e6fc",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "10",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 870,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "b502edc7e45ce251",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "Dist_1_LED controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_LEDController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 520,
        "y": 1840,
        "wires": [
            [
                "209c9e40e526fa6c"
            ]
        ]
    },
    {
        "id": "3ea78dedeaaf4c6f",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 1840,
        "wires": [
            [
                "b502edc7e45ce251"
            ]
        ]
    },
    {
        "id": "209c9e40e526fa6c",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "debug 5",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 700,
        "y": 1840,
        "wires": []
    },
    {
        "id": "ebec3f11f763b5eb",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "",
        "label": "LED",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": false,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 130,
        "y": 1840,
        "wires": [
            [
                "3ea78dedeaaf4c6f"
            ]
        ]
    },
    {
        "id": "a880f70db10cfa4e",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "group": "f325796ebb721579",
        "order": 1,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Lighting",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 140,
        "y": 1780,
        "wires": []
    },
    {
        "id": "a04387180383435c",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "debug 9",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 620,
        "wires": []
    },
    {
        "id": "0834272c61fa1d91",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "스케줄 ON일 때만 1/0 결정 + 상태문구",
        "func": "if (flow.get('miniFan_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // 기본 OFF(1)\nlet text = 'OFF';\nif (hour >= 5 && hour < 23) { val = 0; text = 'ON'; }\n// if (minutes >= 46 && minutes < 47) { val = 0; text = 'ON'; }\n// 출력1: GPIO, 출력2: 상태문구\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// 현재 시간(hour) 가져오기\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // 기본 OFF(1)\n// let text = 'OFF';\n\n\n// // 00시 ~ 06시 사이 ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1460,
        "wires": [
            [
                "43877a5160c9b295"
            ],
            [
                "53e4c030b80e8a42"
            ]
        ]
    },
    {
        "id": "53e4c030b80e8a42",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "group": "f325796ebb721579",
        "order": 6,
        "width": 4,
        "height": 1,
        "name": "Mini Fan Status",
        "label": "Mini Fan Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 970,
        "y": 1380,
        "wires": []
    },
    {
        "id": "1d50e0dd0e72e657",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "스위치 토글 시 현재상태 재표시",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\nconst text = (hour >= 5 && hour < 23) ? 'OFF' : 'ON';\n// const text = (minutes >= 46 && minutes < 47) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 1400,
        "wires": [
            [
                "0834272c61fa1d91"
            ],
            [
                "53e4c030b80e8a42"
            ]
        ]
    },
    {
        "id": "893d48d19cc2c365",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "flow.enable 저장",
        "func": "flow.set('miniFan_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 1360,
        "wires": []
    },
    {
        "id": "4a9a0ff04207202d",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "매 5초마다 실행",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 360,
        "y": 1460,
        "wires": [
            [
                "0834272c61fa1d91"
            ]
        ]
    },
    {
        "id": "bf3cffe8b8bf90c4",
        "type": "inject",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "매 5초마다 실행",
        "props": [],
        "repeat": "5",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "x": 360,
        "y": 1600,
        "wires": [
            [
                "e5c0943a8969389f"
            ]
        ]
    },
    {
        "id": "e5c0943a8969389f",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "스케줄 ON일 때만 1/0 결정 + 상태문구",
        "func": "if (flow.get('circulator_enable') !== true) return null;\nconst now = new Date();\nconst hour = now.getHours(); \nconst minutes = now.getMinutes();\nlet val = 1;               // 기본 OFF(1)\nlet text = 'OFF';\n// if (hour >= 5 && hour < 23) { val = 0; text = 'ON'; }\nif (hour >= 0 && hour < 24) { val = 0; text = 'ON'; }\n// if (minutes >= 25 && minutes < 26) { val = 0; text = 'ON'; }\n// 출력1: GPIO, 출력2: 상태문구\nreturn [ {payload: val}, {payload: text} ];\n\n// if (flow.get('uv_enable') !== true) return null;\n// 현재 시간(hour) 가져오기\n// let now = new Date();\n// let hour = now.getHours();\n// let minutes = now.getMinutes();\n// let pinState = 1;              // 기본 OFF(1)\n// let text = 'OFF';\n\n\n// // 00시 ~ 06시 사이 ON (0)\n// // if (hour >= 0 && hour < 6) {\n// if (minutes >= 22 && minutes < 23) {\n//     pinState = 0; // ON\n// } else {\n//     pinState = 1; // OFF\n// }\n\n// msg.payload = pinState;\n// return msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 670,
        "y": 1600,
        "wires": [
            [
                "249836baa17d7698"
            ],
            [
                "7b17019d9694c425"
            ]
        ]
    },
    {
        "id": "4e27f9d174bd08fd",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "스위치 토글 시 현재상태 재표시",
        "func": "const enabled = (msg.payload === true);\nif (!enabled) { return [{}, {payload:'OFF'}]; }\nconst now = new Date();\nconst hour = now.getHours();\nconst minutes = now.getMinutes();\n// const text = (hour >= 5 && hour < 23) ? 'ON' : 'OFF';\nconst text = (hour >= 0 && hour < 24) ? 'ON' : 'OFF';\n// const text = (minutes >= 25 && minutes < 26) ? 'ON' : 'OFF';\nreturn [ {payload: Date.now()}, {payload: text} ];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 1540,
        "wires": [
            [
                "e5c0943a8969389f"
            ],
            [
                "7b17019d9694c425"
            ]
        ]
    },
    {
        "id": "a807676ee13f76fc",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "name": "flow.enable 저장",
        "func": "flow.set('circulator_enable', msg.payload === true);\nreturn null;",
        "outputs": 0,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 1500,
        "wires": []
    },
    {
        "id": "7b17019d9694c425",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "466f7742a246e74a",
        "group": "",
        "order": 8,
        "width": 4,
        "height": 1,
        "name": "Circulator Status",
        "label": "Circulator Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 970,
        "y": 1520,
        "wires": []
    },
    {
        "id": "inp_a_ml",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "injection volume A and B",
        "label": "A, B input volume",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 13,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 210,
        "y": 2980,
        "wires": [
            [
                "fn_a_save_ml"
            ]
        ]
    },
    {
        "id": "fn_a_save_ml",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "유량 저장 + 시간(초) 계산",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s 가정 → sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // 표시용 소수1자리\nflow.set(\"dist_1_pumpA_volume_ml\", ml);\nflow.set(\"dist_1_pumpA_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 2980,
        "wires": [
            [
                "txt_a_current"
            ]
        ]
    },
    {
        "id": "txt_a_current",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 15,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "AB Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 750,
        "y": 2980,
        "wires": []
    },
    {
        "id": "btn_a_run",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "Start injecting solutions A and B",
        "group": "f325796ebb721579",
        "order": 17,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting A and B",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 190,
        "y": 3040,
        "wires": [
            [
                "fn_a_run_ml"
            ]
        ]
    },
    {
        "id": "fn_a_run_ml",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO25 ON→계산초 후 OFF + 로그/표시(시작만 기록)",
        "func": "const ml = Number(flow.get(\"dist_1_pumpA_volume_ml\"));\nconst sec = Number(flow.get(\"dist_1_pumpA_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"먼저 AB액 투입량(ml)을 입력하세요\");\n  return null\n}\n// 중복 실행 타이머 정리\nconst key = \"dist_1_pumpA_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// 즉시 ON(0) + CSV 1회 기록(START) + UI 갱신\nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_AB_START\", ml, sec),             // CSV: 시작만 기록\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec 후 OFF(1) — CSV 기록 없음, UI만 갱신\nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV 없음\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},AB,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 620,
        "y": 3040,
        "wires": [
            [
                "gpio25_out"
            ],
            [
                "file_a_csv"
            ],
            [
                "txt_a_last"
            ]
        ]
    },
    {
        "id": "gpio25_out",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO17 (0=ON,1=OFF)",
        "pin": "17",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 1510,
        "y": 3020,
        "wires": []
    },
    {
        "id": "txt_a_last",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 18,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (A, B)",
        "label": "Recent inputs (A, B)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1520,
        "y": 3060,
        "wires": []
    },
    {
        "id": "file_a_csv",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "A, B액 로그 CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1520,
        "y": 3120,
        "wires": [
            []
        ]
    },
    {
        "id": "inj_a_header",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "헤더 1회 기록",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 240,
        "y": 3120,
        "wires": [
            [
                "fn_a_header_guard"
            ]
        ]
    },
    {
        "id": "fn_a_header_guard",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "헤더 중복 방지",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 3120,
        "wires": [
            [
                "file_a_csv"
            ]
        ]
    },
    {
        "id": "e10e368c452dd270",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "injection volume Acid",
        "label": "Acid input volume",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 12,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 230,
        "y": 3220,
        "wires": [
            [
                "2b753df6afdd64b6"
            ]
        ]
    },
    {
        "id": "2b753df6afdd64b6",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "유량 저장 + 시간(초) 계산",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s 가정 → sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // 표시용 소수1자리\nflow.set(\"dist_1_pumpC_volume_ml\", ml);\nflow.set(\"dist_1_pumpC_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 3220,
        "wires": [
            [
                "eaae89fb0638005f"
            ]
        ]
    },
    {
        "id": "eaae89fb0638005f",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 14,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "Acid Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 750,
        "y": 3220,
        "wires": []
    },
    {
        "id": "a87b84159b60d57f",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "Start injecting Acid solutions",
        "group": "f325796ebb721579",
        "order": 16,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting Acid",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 180,
        "y": 3280,
        "wires": [
            [
                "7284d4e9e0010867"
            ]
        ]
    },
    {
        "id": "7284d4e9e0010867",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO25 ON→계산초 후 OFF + 로그/표시(시작만 기록)",
        "func": "const ml = Number(flow.get(\"dist_1_pumpC_volume_ml\"));\nconst sec = Number(flow.get(\"dist_1_pumpC_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"먼저 C액 투입량(ml)을 입력하세요\");\n  return null;\n}\n// 중복 실행 타이머 정리\nconst key = \"dist_1_pumpC_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// 즉시 ON(0) + CSV 1회 기록(START) + UI 갱신\nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_C_START\", ml, sec),             // CSV: 시작만 기록\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec 후 OFF(1) — CSV 기록 없음, UI만 갱신\nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV 없음\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},Acid,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 3280,
        "wires": [
            [
                "1a838d3ee158ae54"
            ],
            [
                "6dddb568535969eb"
            ],
            [
                "6044e01bb19ae4bc"
            ]
        ]
    },
    {
        "id": "1a838d3ee158ae54",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "GPIO21 (0=ON,1=OFF)",
        "pin": "21",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 1530,
        "y": 3260,
        "wires": []
    },
    {
        "id": "6044e01bb19ae4bc",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "group": "f325796ebb721579",
        "order": 19,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (Acid)",
        "label": "Recent inputs (Acid)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 1500,
        "y": 3300,
        "wires": []
    },
    {
        "id": "6dddb568535969eb",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "산성액 로그 CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 1460,
        "y": 3360,
        "wires": [
            []
        ]
    },
    {
        "id": "7715901eb0e673bd",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "헤더 1회 기록",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 240,
        "y": 3360,
        "wires": [
            [
                "f97336f95369f779"
            ]
        ]
    },
    {
        "id": "f97336f95369f779",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "912ed1b86333869f",
        "name": "헤더 중복 방지",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 3360,
        "wires": [
            [
                "6dddb568535969eb"
            ]
        ]
    },
    {
        "id": "577253202c73b09c",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "Dist 1 Pump controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_PumpController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 540,
        "y": 2200,
        "wires": [
            [
                "839c019b8d38b1ce"
            ]
        ]
    },
    {
        "id": "3725b711ea5e2772",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 2200,
        "wires": [
            [
                "577253202c73b09c"
            ]
        ]
    },
    {
        "id": "839c019b8d38b1ce",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "debug 10",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 740,
        "y": 2200,
        "wires": []
    },
    {
        "id": "2338e23a2b4a1061",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "",
        "label": "Pump",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 10,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 130,
        "y": 2200,
        "wires": [
            [
                "3725b711ea5e2772"
            ]
        ]
    },
    {
        "id": "7164aeb31763ab09",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "group": "f325796ebb721579",
        "order": 9,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Nutrient solution control",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 190,
        "y": 2140,
        "wires": []
    },
    {
        "id": "996be92bd9d2ab16",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "UV Automation",
        "label": "UV Automation",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 140,
        "y": 2000,
        "wires": [
            [
                "7def7b8e65cbddcc"
            ]
        ]
    },
    {
        "id": "a19b61fd61a05499",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist_1_UV controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_UVController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 560,
        "y": 2000,
        "wires": [
            [
                "34196794c1698420"
            ]
        ]
    },
    {
        "id": "7def7b8e65cbddcc",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 2000,
        "wires": [
            [
                "a19b61fd61a05499"
            ]
        ]
    },
    {
        "id": "34196794c1698420",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 2000,
        "wires": []
    },
    {
        "id": "1753d4563875309b",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Solution Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.Solution_Temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 1100,
        "wires": [
            [
                "1aa3bbe8afdc012d",
                "7e26ce5601b49a9c",
                "27b92651c8adebe9"
            ]
        ]
    },
    {
        "id": "1aa3bbe8afdc012d",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist 1 S.T",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 1100,
        "wires": []
    },
    {
        "id": "7e26ce5601b49a9c",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "c5fb925fb5ca84e9",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Solution Temperature",
        "label": "Cº",
        "format": "{{value}}",
        "min": "0",
        "max": "30",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "17",
        "seg2": "23",
        "diff": false,
        "className": "",
        "x": 960,
        "y": 1160,
        "wires": []
    },
    {
        "id": "27b92651c8adebe9",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "group": "",
        "order": 8,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "30",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 960,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "d3d5c208297b5bcb",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "CO2",
        "rules": [
            {
                "t": "move",
                "p": "payload.co2",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 460,
        "wires": [
            [
                "ce91a081135d3653",
                "a81d2b73695ec428",
                "f033277dce8c9fc3"
            ]
        ]
    },
    {
        "id": "ce91a081135d3653",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "CO2 debug",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 440,
        "wires": []
    },
    {
        "id": "a81d2b73695ec428",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "c888f82b8cc4653a",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "CO2",
        "label": "ppm",
        "format": "{{value}}",
        "min": "30",
        "max": "1000",
        "colors": [
            "#ca3838",
            "#00b500",
            "#ca3838"
        ],
        "seg1": "300",
        "seg2": "800",
        "diff": false,
        "className": "",
        "x": 910,
        "y": 480,
        "wires": []
    },
    {
        "id": "f033277dce8c9fc3",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "17b6e50d0d55a4f0",
        "name": "",
        "group": "",
        "order": 24,
        "width": 6,
        "height": 5,
        "label": "CO2",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "30",
        "ymax": "1000",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 910,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "1caf8a5c5e3446a5",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Solution Temperature",
        "rules": [
            {
                "t": "move",
                "p": "payload.Solution_Temperature",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 1100,
        "wires": [
            [
                "25a1fc18f884cf3a",
                "12a11f4918b20262",
                "ada6e5f91605f50b"
            ]
        ]
    },
    {
        "id": "25a1fc18f884cf3a",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 S.T",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2060,
        "y": 1100,
        "wires": []
    },
    {
        "id": "12a11f4918b20262",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 3,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "Solution Temperature",
        "label": "Cº",
        "format": "{{value}}",
        "min": "0",
        "max": "30",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "17",
        "seg2": "23",
        "diff": false,
        "className": "",
        "x": 2100,
        "y": 1160,
        "wires": []
    },
    {
        "id": "ada6e5f91605f50b",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 8,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "30",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2100,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "ded04047b201eda5",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1260,
        "y": 680,
        "wires": [
            [
                "3f103b9815f86dd4"
            ]
        ]
    },
    {
        "id": "3f103b9815f86dd4",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist_2_EC_pH",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_EC_pH.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1460,
        "y": 680,
        "wires": [
            [
                "27c51267c346f89a"
            ]
        ]
    },
    {
        "id": "27c51267c346f89a",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1610,
        "y": 680,
        "wires": [
            [
                "882bd2a1db484c7a",
                "83ef16bf59648dba",
                "523fb7d4146c728e",
                "23d54e14bb05b234",
                "1caf8a5c5e3446a5"
            ]
        ]
    },
    {
        "id": "882bd2a1db484c7a",
        "type": "change",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "Date str",
        "rules": [
            {
                "t": "move",
                "p": "payload.date",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1800,
        "y": 680,
        "wires": [
            [
                "2c23a9c69bfd5964"
            ]
        ]
    },
    {
        "id": "83ef16bf59648dba",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "EC",
        "rules": [
            {
                "t": "move",
                "p": "payload.EC",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 740,
        "wires": [
            [
                "19575127be6263da",
                "55c7596a34b371e7",
                "10a137bf882b5184"
            ]
        ]
    },
    {
        "id": "523fb7d4146c728e",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "pH",
        "rules": [
            {
                "t": "move",
                "p": "payload.pH",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1790,
        "y": 940,
        "wires": [
            [
                "7c25ba5dd16a36b6",
                "1b55bb39740ed3db",
                "1236be8eabaf376f"
            ]
        ]
    },
    {
        "id": "19575127be6263da",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 EC",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2000,
        "y": 740,
        "wires": []
    },
    {
        "id": "7c25ba5dd16a36b6",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "Dist 2 pH",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2000,
        "y": 940,
        "wires": []
    },
    {
        "id": "2c23a9c69bfd5964",
        "type": "function",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "Date str to date",
        "func": "// Get the input string from msg.payload\nlet valueString = msg.payload;  // e.g., \"2025-06-17 18:13\"\n\n// Replace space with 'T' to ensure proper ISO 8601 format\nlet isoFormat = valueString.replace(\" \", \"T\");\n\n// Convert the string to a JavaScript Date object\nlet dateObj = new Date(isoFormat);\nmsg.payload = dateObj\n\n// Check if the date is valid\n//if (isNaN(dateObj.getTime())) {\n//    msg.payload = { error: \"Invalid date format\" };\n//} else {\n//    msg.payload = {\n//        original: valueString,\n//        date: dateObj\n//    };\n//}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1980,
        "y": 680,
        "wires": [
            [
                "bed3ea5061f3aa42"
            ]
        ]
    },
    {
        "id": "bed3ea5061f3aa42",
        "type": "debug",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "debug 17",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 2160,
        "y": 680,
        "wires": []
    },
    {
        "id": "55c7596a34b371e7",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 1,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "EC",
        "label": "mS/cm",
        "format": "{{value}}",
        "min": "0",
        "max": "3",
        "colors": [
            "#00b500",
            "#00b500",
            "#b50000"
        ],
        "seg1": "",
        "seg2": "1.8",
        "diff": false,
        "className": "",
        "x": 2010,
        "y": 800,
        "wires": []
    },
    {
        "id": "1b55bb39740ed3db",
        "type": "ui_gauge",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "",
        "group": "aa578847983587e6",
        "order": 2,
        "width": 6,
        "height": 5,
        "gtype": "gage",
        "title": "pH",
        "label": "",
        "format": "{{value}}",
        "min": "0",
        "max": "10",
        "colors": [
            "#b50000",
            "#00b500",
            "#b50000"
        ],
        "seg1": "5.5",
        "seg2": "7",
        "diff": false,
        "className": "",
        "x": 2010,
        "y": 1000,
        "wires": []
    },
    {
        "id": "10a137bf882b5184",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 9,
        "width": 6,
        "height": 5,
        "label": "EC",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "3",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2010,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "1236be8eabaf376f",
        "type": "ui_chart",
        "z": "84f9df6667326f98",
        "d": true,
        "g": "3eaca329610704eb",
        "name": "",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:MM",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "10",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "604800",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 2010,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "23d54e14bb05b234",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "3eaca329610704eb",
        "name": "debug 18",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1760,
        "y": 620,
        "wires": []
    },
    {
        "id": "ui_auto_switch",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "Auto Mode",
        "label": "Auto mode",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 11,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 130,
        "y": 3460,
        "wires": [
            [
                "fn_set_auto_flag",
                "b17d8c4a3bca04cb"
            ]
        ]
    },
    {
        "id": "fn_set_auto_flag",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "set flow.auto_mode",
        "func": "flow.set('auto_mode', !!msg.payload);\nreturn {payload: flow.get('auto_mode')};",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 3460,
        "wires": [
            []
        ]
    },
    {
        "id": "b17d8c4a3bca04cb",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 160,
        "y": 3540,
        "wires": [
            [
                "7cf8ec733dff273c"
            ]
        ]
    },
    {
        "id": "7cf8ec733dff273c",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "Dist 1 EC pH Automation",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_1_EC_pH_auto_control.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 390,
        "y": 3540,
        "wires": [
            [
                "57f723a2128c43d5",
                "977cea532afc089a"
            ]
        ]
    },
    {
        "id": "7a499e2de11fb75a",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "Dist_2_LED controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_LEDController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1400,
        "y": 1980,
        "wires": [
            [
                "0b9b9d5aae2018ff"
            ]
        ]
    },
    {
        "id": "e08d25bb4b05e048",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 1980,
        "wires": [
            [
                "7a499e2de11fb75a"
            ]
        ]
    },
    {
        "id": "0b9b9d5aae2018ff",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "debug 19",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1580,
        "y": 1980,
        "wires": []
    },
    {
        "id": "ef29638c34485786",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "",
        "label": "LED",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1010,
        "y": 1980,
        "wires": [
            [
                "e08d25bb4b05e048"
            ]
        ]
    },
    {
        "id": "a1e65c136a4faf8e",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "group": "e3eac795c3a63651",
        "order": 1,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Lighting",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 1020,
        "y": 1920,
        "wires": []
    },
    {
        "id": "4f385e73050961e1",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "Dist 2 Pump controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_PumpController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1400,
        "y": 2360,
        "wires": [
            [
                "63e650f897ae7cfe"
            ]
        ]
    },
    {
        "id": "f15e7c328f5d7fd4",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 2360,
        "wires": [
            [
                "4f385e73050961e1"
            ]
        ]
    },
    {
        "id": "63e650f897ae7cfe",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "debug 20",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1600,
        "y": 2360,
        "wires": []
    },
    {
        "id": "3aa9a7e96d4cfe09",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "",
        "label": "Pump",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 5,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 990,
        "y": 2360,
        "wires": [
            [
                "f15e7c328f5d7fd4"
            ]
        ]
    },
    {
        "id": "e320eb5d6e113614",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "group": "e3eac795c3a63651",
        "order": 4,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Nutrient solution control",
        "format": "{{msg.payload}}",
        "layout": "row-center",
        "className": "",
        "style": true,
        "font": "Arial,Arial,Helvetica,sans-serif",
        "fontSize": "25",
        "color": "#ffffff",
        "x": 1050,
        "y": 2300,
        "wires": []
    },
    {
        "id": "032638cc6c5fc9f2",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "injection volume A and B",
        "label": "A, B input volume",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 1910,
        "y": 2980,
        "wires": [
            [
                "742c215264b52d5d"
            ]
        ]
    },
    {
        "id": "742c215264b52d5d",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "유량 저장 + 시간(초) 계산",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s 가정 → sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // 표시용 소수1자리\nflow.set(\"dist_2_pumpA_volume_ml\", ml);\nflow.set(\"dist_2_pumpA_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2190,
        "y": 2980,
        "wires": [
            [
                "66ddab9642e34173"
            ]
        ]
    },
    {
        "id": "66ddab9642e34173",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 10,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "AB Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 2450,
        "y": 2980,
        "wires": []
    },
    {
        "id": "e4a0abcae8745f5d",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "Start injecting solutions A and B",
        "group": "e3eac795c3a63651",
        "order": 12,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting A and B",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1890,
        "y": 3040,
        "wires": [
            [
                "80cc8c87a9dcdff5"
            ]
        ]
    },
    {
        "id": "80cc8c87a9dcdff5",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO25 ON→계산초 후 OFF + 로그/표시(시작만 기록)",
        "func": "const ml = Number(flow.get(\"dist_2_pumpA_volume_ml\"));\nconst sec = Number(flow.get(\"dist_2_pumpA_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"먼저 AB액 투입량(ml)을 입력하세요\");\n  return null;\n}\n// 중복 실행 타이머 정리\nconst key = \"dist_2_pumpA_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// 즉시 ON(0) + CSV 1회 기록(START) + UI 갱신\nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_AB_START\", ml, sec),             // CSV: 시작만 기록\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec 후 OFF(1) — CSV 기록 없음, UI만 갱신\nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV 없음\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},AB,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2320,
        "y": 3040,
        "wires": [
            [
                "c7fe5d35e20589ec"
            ],
            [
                "ce77e02c54e5281c"
            ],
            [
                "e0b97cfcaafbe7a8"
            ]
        ]
    },
    {
        "id": "c7fe5d35e20589ec",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO22 (0=ON,1=OFF)",
        "pin": "22",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 3190,
        "y": 3020,
        "wires": []
    },
    {
        "id": "e0b97cfcaafbe7a8",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 13,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (A, B)",
        "label": "Recent inputs (A, B)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 3180,
        "y": 3080,
        "wires": []
    },
    {
        "id": "ce77e02c54e5281c",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "A, B액 로그 CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 3160,
        "y": 3120,
        "wires": [
            []
        ]
    },
    {
        "id": "d77f241745577d87",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "헤더 1회 기록",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 1940,
        "y": 3120,
        "wires": [
            [
                "f7516acac2b29596"
            ]
        ]
    },
    {
        "id": "f7516acac2b29596",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "헤더 중복 방지",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 3120,
        "wires": [
            [
                "ce77e02c54e5281c"
            ]
        ]
    },
    {
        "id": "abf0f3cd0103cc31",
        "type": "ui_text_input",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "injection volume Acid",
        "label": "Acid input volume",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "mode": "number",
        "delay": 300,
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 1930,
        "y": 3220,
        "wires": [
            [
                "083acd90c241f25d"
            ]
        ]
    },
    {
        "id": "083acd90c241f25d",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "유량 저장 + 시간(초) 계산",
        "func": "const ml = Number(msg.payload);\nif (isNaN(ml) || ml <= 0) return null;\n// 1.613 ml/s 가정 → sec = ml / 1.613\n// const secRaw = ml / 1.613;\n// const secRaw = ml / 1.6667;\nconst secRaw = ml / 1.65;\nconst secDisp = Math.round(secRaw * 10) / 10; // 표시용 소수1자리\nflow.set(\"dist_2_pumpC_volume_ml\", ml);\nflow.set(\"dist_2_pumpC_duration_sec\", secRaw);\nreturn { payload: `${ml} ml (${secDisp} s)` };",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2190,
        "y": 3220,
        "wires": [
            [
                "972eec39af78be9a"
            ]
        ]
    },
    {
        "id": "972eec39af78be9a",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 9,
        "width": 4,
        "height": 1,
        "name": "Setting",
        "label": "Acid Setting",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 2450,
        "y": 3220,
        "wires": []
    },
    {
        "id": "ada5f246a3285a35",
        "type": "ui_button",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "Start injecting Acid solutions",
        "group": "e3eac795c3a63651",
        "order": 11,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Start injecting Acid",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 1880,
        "y": 3280,
        "wires": [
            [
                "67dfe99f35a05924"
            ]
        ]
    },
    {
        "id": "67dfe99f35a05924",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO25 ON→계산초 후 OFF + 로그/표시(시작만 기록)",
        "func": "const ml = Number(flow.get(\"dist_2_pumpC_volume_ml\"));\nconst sec = Number(flow.get(\"dist_2_pumpC_duration_sec\"));\nif (!ml || isNaN(ml) || !sec || isNaN(sec)) {\n  node.warn(\"먼저 C액 투입량(ml)을 입력하세요\");\n  return null;\n}\n// 중복 실행 타이머 정리\nconst key = \"dist_2_pumpC_timer\";\nconst prev = context.get(key);\nif (prev) { clearTimeout(prev); context.set(key, null); }\n\n// 즉시 ON(0) + CSV 1회 기록(START) + UI 갱신\nnode.send([\n  { payload: 0 },                                  // GPIO ON (0)\n  makeCsvMsg(\"PUMP_C_START\", ml, sec),             // CSV: 시작만 기록\n  makeUiMsg(\"Start\")                            // UI\n]);\n\n// sec 후 OFF(1) — CSV 기록 없음, UI만 갱신\nconst timer = setTimeout(() => {\n  node.send([\n    { payload: 1 },                                // GPIO OFF (1)\n    null,                                          // CSV 없음\n    makeUiMsg(\"Complete\")                          // UI\n  ]);\n  context.set(key, null);\n}, Math.max(0, sec * 1000));\ncontext.set(key, timer);\nreturn null;\n\nfunction makeCsvMsg(action, ml, sec){\n  const ts = nowStr();\n  const secDisp = Math.round(sec*10)/10;\n  return { payload: `${ts},Acid,volume,${ml},duration,${secDisp}s` };\n}\nfunction makeUiMsg(tag){\n  const ts = nowStr();\n  return { payload: `Last Run: ${ts} (${tag})` };\n}\nfunction nowStr(){\n  const now = new Date();\n  const yyyy = now.getFullYear();\n  const mm = String(now.getMonth()+1).padStart(2, '0');\n  const dd = String(now.getDate()).padStart(2, '0');\n  const hh = String(now.getHours()).padStart(2, '0');\n  const mi = String(now.getMinutes()).padStart(2, '0');\n  const ss = String(now.getSeconds()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd} ${hh}:${mi}:${ss}`;\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2240,
        "y": 3280,
        "wires": [
            [
                "21fc1765b77482f9"
            ],
            [
                "8bfc716cf46fb70d"
            ],
            [
                "f37eddb8c684e4ec"
            ]
        ]
    },
    {
        "id": "21fc1765b77482f9",
        "type": "rpi-gpio out",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "GPIO23 (0=ON,1=OFF)",
        "pin": "23",
        "set": true,
        "level": "1",
        "freq": "",
        "out": "out",
        "bcm": true,
        "x": 3190,
        "y": 3260,
        "wires": []
    },
    {
        "id": "f37eddb8c684e4ec",
        "type": "ui_text",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "group": "e3eac795c3a63651",
        "order": 14,
        "width": 8,
        "height": 1,
        "name": "Recent inputs (Acid)",
        "label": "Recent inputs (Acid)",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": "",
        "color": "#000000",
        "x": 3180,
        "y": 3320,
        "wires": []
    },
    {
        "id": "8bfc716cf46fb70d",
        "type": "file",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "산성액 로그 CSV",
        "filename": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_2_Solution_input_log.csv",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "none",
        "x": 3160,
        "y": 3380,
        "wires": [
            []
        ]
    },
    {
        "id": "d4e056cc41c01da1",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "헤더 1회 기록",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.5,
        "topic": "",
        "payload": "timestamp,device,action,detail",
        "payloadType": "str",
        "x": 1940,
        "y": 3360,
        "wires": [
            [
                "78091ee38cd1e0cc"
            ]
        ]
    },
    {
        "id": "78091ee38cd1e0cc",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "b1927e4ba08d43c4",
        "name": "헤더 중복 방지",
        "func": "if (flow.get('pumpA_csv_header_written')) return null;\nflow.set('pumpA_csv_header_written', true);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2160,
        "y": 3360,
        "wires": [
            [
                "8bfc716cf46fb70d"
            ]
        ]
    },
    {
        "id": "87d673785a0f96f7",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "name": "",
        "label": "Fan",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 1050,
        "y": 1800,
        "wires": [
            [
                "eaabd177f90f6e07"
            ]
        ]
    },
    {
        "id": "eaabd177f90f6e07",
        "type": "change",
        "z": "84f9df6667326f98",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1220,
        "y": 1800,
        "wires": [
            [
                "07b2bd530ce25200"
            ]
        ]
    },
    {
        "id": "07b2bd530ce25200",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "name": "Dist 2 Fan controller",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_FanController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 1460,
        "y": 1800,
        "wires": [
            [
                "db5a25ff25f37f3e"
            ]
        ]
    },
    {
        "id": "db5a25ff25f37f3e",
        "type": "debug",
        "z": "84f9df6667326f98",
        "name": "debug 22",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1660,
        "y": 1800,
        "wires": []
    },
    {
        "id": "57f723a2128c43d5",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "Auto mode code",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 3600,
        "wires": []
    },
    {
        "id": "9a4c7a02cad47b84",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "Dist_1_EC_pH",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/sensors/Dist_1_EC_pH.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 320,
        "y": 680,
        "wires": [
            [
                "13c6bea38d428920"
            ]
        ]
    },
    {
        "id": "b221c02018673863",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "e8ce93fc01bd7af9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 680,
        "wires": [
            [
                "9a4c7a02cad47b84"
            ]
        ]
    },
    {
        "id": "407bba549c9d5227",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "5d6e724936f68d35",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 130,
        "y": 1900,
        "wires": [
            [
                "3ea78dedeaaf4c6f"
            ]
        ]
    },
    {
        "id": "53bfde506c6ea7dd",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "915bc3b1ca228f03",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 130,
        "y": 2260,
        "wires": [
            [
                "3725b711ea5e2772"
            ]
        ]
    },
    {
        "id": "ae4b9c4ddf882e9b",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "978a9587f7a84adc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 990,
        "y": 2420,
        "wires": [
            [
                "f15e7c328f5d7fd4"
            ]
        ]
    },
    {
        "id": "0fcda68765a6a783",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "ad1743f076448914",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 1010,
        "y": 2040,
        "wires": [
            [
                "e08d25bb4b05e048"
            ]
        ]
    },
    {
        "id": "5a5c0e99a6f8248b",
        "type": "inject",
        "z": "84f9df6667326f98",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 1050,
        "y": 1840,
        "wires": [
            [
                "eaabd177f90f6e07"
            ]
        ]
    },
    {
        "id": "8fa22229c3c25e01",
        "type": "inject",
        "z": "84f9df6667326f98",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 130,
        "y": 2040,
        "wires": [
            [
                "7def7b8e65cbddcc"
            ]
        ]
    },
    {
        "id": "91b2109638828671",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "",
        "label": "Circulator",
        "tooltip": "",
        "group": "f325796ebb721579",
        "order": 7,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": false,
        "className": "",
        "x": 340,
        "y": 1660,
        "wires": [
            [
                "dca8353ba4f4c218"
            ]
        ]
    },
    {
        "id": "dca8353ba4f4c218",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 520,
        "y": 1660,
        "wires": [
            [
                "29ecb140bf1f8d74"
            ]
        ]
    },
    {
        "id": "9527ba84ddcf42d2",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 330,
        "y": 1720,
        "wires": [
            [
                "dca8353ba4f4c218"
            ]
        ]
    },
    {
        "id": "29ecb140bf1f8d74",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "466f7742a246e74a",
        "name": "Circulator",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/AirCirculatorController.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 740,
        "y": 1660,
        "wires": [
            []
        ]
    },
    {
        "id": "59b0ff71adae82a7",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "parse python JSON",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 850,
        "y": 3540,
        "wires": [
            [
                "ccf0ccf62190c269"
            ]
        ]
    },
    {
        "id": "ccf0ccf62190c269",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "Dispatch GPIO by topic",
        "func": "// Expect msg.payload to be an object after JSON node.\nconst p = msg.payload;\n\n// outputs:\n// 1: GPIO17\n// 2: GPIO21\n// 3: AB CSV line\n// 4: Acid CSV line\n// 5: AB Recent ui_text\n// 6: Acid Recent ui_text\n\nif (!p || typeof p !== \"object\") return [null, null, null, null, null, null];\n\n// 1) GPIO commands\n// {type:\"gpio\", topic:\"GPIO17\"|\"GPIO21\", payload:0|1}\nif (p.type === \"gpio\") {\n  const t = String(p.topic || \"\");\n  const v = Number(p.payload);\n\n  if (t === \"GPIO17\") return [{ payload: v }, null, null, null, null, null];\n  if (t === \"GPIO21\") return [null, { payload: v }, null, null, null, null];\n\n  return [null, null, null, null, null, null];\n}\n\n// 2) Log lines\n// {type:\"log\", device:\"AB\"|\"Acid\", payload:\"2026-... ,Acid,volume,2.0,duration,1.2s\"}\nif (p.type === \"log\") {\n  const dev = String(p.device || \"\");\n  const line = String(p.payload || \"\");\n  if (!line) return [null, null, null, null, null, null];\n\n  if (dev === \"AB\") {\n    // CSV + UI 둘 다 보냄\n    return [null, null, { payload: line }, null, { payload: line }, null];\n  }\n  if (dev === \"Acid\") {\n    return [null, null, null, { payload: line }, null, { payload: line }];\n  }\n\n  return [null, null, null, null, null, null];\n}\n\nreturn [null, null, null, null, null, null];\n",
        "outputs": 6,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1070,
        "y": 3540,
        "wires": [
            [
                "gpio25_out"
            ],
            [
                "1a838d3ee158ae54"
            ],
            [
                "file_a_csv"
            ],
            [
                "6dddb568535969eb"
            ],
            [
                "txt_a_last"
            ],
            [
                "6044e01bb19ae4bc"
            ]
        ]
    },
    {
        "id": "977cea532afc089a",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "split lines to JSON msgs",
        "func": "// Split msg.payload (multi-line string) into multiple messages, 1 JSON per line.\nconst raw = msg.payload;\n\n// If it's already an object, just pass through.\nif (raw && typeof raw === \"object\" && !Buffer.isBuffer(raw)) return msg;\n\n// Convert to string safely\nlet s = Buffer.isBuffer(raw) ? raw.toString(\"utf8\") : (raw ?? \"\").toString();\n\n// If multiple JSON objects are glued together without newline, normalize them\ns = s.replace(/}\\s*{/g, \"}\\n{\");\n\n// Split lines, trim, drop empty\nconst lines = s.split(/\\r?\\n/).map(l => l.trim()).filter(l => l.length > 0);\n\n// No lines -> drop\nif (lines.length === 0) return null;\n\n// Emit one msg per line\nreturn lines.map(line => ({ ...msg, payload: line }));\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 630,
        "y": 3540,
        "wires": [
            [
                "59b0ff71adae82a7"
            ]
        ]
    },
    {
        "id": "7dcc7bbc6be0b9f7",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "89edff7748839507",
        "name": "false",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 130,
        "y": 3620,
        "wires": [
            [
                "b17d8c4a3bca04cb"
            ]
        ]
    },
    {
        "id": "8f09733d80d00645",
        "type": "ui_switch",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "Auto Mode",
        "label": "Auto mode",
        "tooltip": "",
        "group": "e3eac795c3a63651",
        "order": 6,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "false",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "true",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 1750,
        "y": 3540,
        "wires": [
            [
                "13cb5d10e2e2abf5"
            ]
        ]
    },
    {
        "id": "13cb5d10e2e2abf5",
        "type": "change",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "boolean to str",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "false",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "true",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1960,
        "y": 3540,
        "wires": [
            [
                "d97d2f46df0c69b4"
            ]
        ]
    },
    {
        "id": "d97d2f46df0c69b4",
        "type": "pythonshell in",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "Dist 2 EC pH Automation",
        "pyfile": "/home/cja/Work/cja-skyfarms-project/controllers/Dist_2_EC_pH_auto_control.py",
        "virtualenv": "",
        "continuous": true,
        "stdInData": true,
        "x": 2190,
        "y": 3540,
        "wires": [
            [
                "386503bda4f5c254",
                "97a7ee0f561696f6"
            ]
        ]
    },
    {
        "id": "386503bda4f5c254",
        "type": "debug",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "Auto mode code",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2380,
        "y": 3600,
        "wires": []
    },
    {
        "id": "11668b201f94f5a6",
        "type": "json",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "parse python JSON",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 2650,
        "y": 3540,
        "wires": [
            [
                "d172c8ca1a88f8c0"
            ]
        ]
    },
    {
        "id": "d172c8ca1a88f8c0",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "Dispatch GPIO by topic",
        "func": "// Expect msg.payload to be an object after JSON node.\nconst p = msg.payload;\n\n// outputs:\n// 1: GPIO22\n// 2: GPIO23\n// 3: AB CSV line\n// 4: Acid CSV line\n// 5: AB Recent ui_text\n// 6: Acid Recent ui_text\n\nif (!p || typeof p !== \"object\") return [null, null, null, null, null, null];\n\n// 1) GPIO commands\n// {type:\"gpio\", topic:\"GPIO22\"|\"GPIO23\", payload:0|1}\nif (p.type === \"gpio\") {\n  const t = String(p.topic || \"\");\n  const v = Number(p.payload);\n\n  if (t === \"GPIO22\") return [{ payload: v }, null, null, null, null, null];\n  if (t === \"GPIO23\") return [null, { payload: v }, null, null, null, null];\n\n  return [null, null, null, null, null, null];\n}\n\n// 2) Log lines\n// {type:\"log\", device:\"AB\"|\"Acid\", payload:\"2026-... ,Acid,volume,2.0,duration,1.2s\"}\nif (p.type === \"log\") {\n  const dev = String(p.device || \"\");\n  const line = String(p.payload || \"\");\n  if (!line) return [null, null, null, null, null, null];\n\n  if (dev === \"AB\") {\n    // CSV + UI 둘 다 보냄\n    return [null, null, { payload: line }, null, { payload: line }, null];\n  }\n  if (dev === \"Acid\") {\n    return [null, null, null, { payload: line }, null, { payload: line }];\n  }\n\n  return [null, null, null, null, null, null];\n}\n\nreturn [null, null, null, null, null, null];\n",
        "outputs": 6,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2870,
        "y": 3540,
        "wires": [
            [
                "c7fe5d35e20589ec"
            ],
            [
                "21fc1765b77482f9"
            ],
            [
                "ce77e02c54e5281c"
            ],
            [
                "8bfc716cf46fb70d"
            ],
            [
                "e0b97cfcaafbe7a8"
            ],
            [
                "f37eddb8c684e4ec"
            ]
        ]
    },
    {
        "id": "97a7ee0f561696f6",
        "type": "function",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "split lines to JSON msgs",
        "func": "// Split msg.payload (multi-line string) into multiple messages, 1 JSON per line.\nconst raw = msg.payload;\n\n// If it's already an object, just pass through.\nif (raw && typeof raw === \"object\" && !Buffer.isBuffer(raw)) return msg;\n\n// Convert to string safely\nlet s = Buffer.isBuffer(raw) ? raw.toString(\"utf8\") : (raw ?? \"\").toString();\n\n// If multiple JSON objects are glued together without newline, normalize them\ns = s.replace(/}\\s*{/g, \"}\\n{\");\n\n// Split lines, trim, drop empty\nconst lines = s.split(/\\r?\\n/).map(l => l.trim()).filter(l => l.length > 0);\n\n// No lines -> drop\nif (lines.length === 0) return null;\n\n// Emit one msg per line\nreturn lines.map(line => ({ ...msg, payload: line }));\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2430,
        "y": 3540,
        "wires": [
            [
                "11668b201f94f5a6"
            ]
        ]
    },
    {
        "id": "46aa6ebe59e28fc0",
        "type": "inject",
        "z": "84f9df6667326f98",
        "g": "121d5ec0629dc581",
        "name": "false",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "str",
        "x": 1750,
        "y": 3600,
        "wires": [
            [
                "13cb5d10e2e2abf5"
            ]
        ]
    },
    {
        "id": "9a7f2b6b84f6a001",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Every 1 hr",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 120,
        "wires": [
            [
                "8d576cf243516148"
            ]
        ]
    },
    {
        "id": "2c1d3e4f5a6b7c80",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "EC (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "EC (dS/m)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "",
        "ymax": "3",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "3d2e4f5a6b7c8d90",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "pH (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "1",
        "ymax": "10",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "4e3f5a6b7c8d9ea0",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Solution Temp (last 7 days)",
        "group": "c5fb925fb5ca84e9",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature (°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "10",
        "ymax": "35",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "10de8cbe4af04315",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Every 1 hr",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 380,
        "wires": [
            [
                "6b044a38741310f6"
            ]
        ]
    },
    {
        "id": "84915ae7f5c9b3c6",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "EC (last 7 days)",
        "group": "aa578847983587e6",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "EC (dS/m)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "0",
        "ymax": "3",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "7b2f5b8520aa74d8",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "pH (last 7 days)",
        "group": "aa578847983587e6",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "pH",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "1",
        "ymax": "10",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1280,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "6104d3b154bae62a",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Solution Temp (last 7 days)",
        "group": "aa578847983587e6",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "Solution Temperature (°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "No data",
        "dot": false,
        "ymin": "10",
        "ymax": "35",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "11c49a6273f636d3",
        "type": "inject",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Every 1 hr",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": 1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 680,
        "wires": [
            [
                "e9bba788651eb3d4"
            ]
        ]
    },
    {
        "id": "efb0d37433575254",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Filter last 7 days & split",
        "func": "/**\n * Room Condition Chart Data Processor\n * Input: msg.payload (Array of rows from SQLite)\n * Expected Columns: Date, Temperature, Humidity, CO2\n */\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\nconst MAX_POINTS = 500;     // UI 성능을 위한 최대 포인트 제한\nconst DEBUG_LOG = false;\n\n// --- Helpers ---\n\n/**\n * 타임존 수정: \"YYYY-MM-DD HH:mm\"을 로컬 시간으로 파싱\n * 하이픈(-)을 슬래시(/)로 바꿔야 자바스크립트가 UTC로 오해하지 않습니다.\n */\nfunction toMs(dateStr) {\n    if (!dateStr) return null;\n    const s = String(dateStr).trim();\n    const localFormat = s.replace(/-/g, \"/\");\n    const t = new Date(localFormat).getTime();\n    return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n    if (v === null || v === undefined) return null;\n    if (typeof v === \"number\") return Number.isFinite(v) ? v : null;\n    const s = String(v).trim();\n    if (!s.length) return null;\n    const n = Number(s);\n    return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n    arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n    return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n    if (arr.length <= maxPoints) return arr;\n    const step = Math.ceil(arr.length / maxPoints);\n    const out = [];\n    for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n    return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n    if (arr.length <= maxPoints) return arr;\n    const tail = arr.slice(-maxPoints * 4);\n    return downsampleEvenly(tail, maxPoints);\n}\n\n// --- 데이터 빌드 ---\n\nconst outT = [];\nconst outH = [];\nconst outC = [];\n\nfor (const r of rows) {\n    const t = toMs(r.Date);\n    if (t === null) continue;\n\n    const temp = toNum(r.Temperature);\n    const humi = toNum(r.Humidity);\n    const co2 = toNum(r.CO2);\n\n    // 차트 노드에 보낼 데이터 포인트 객체 생성\n    if (temp !== null) outT.push({ x: t, y: temp });\n    if (humi !== null) outH.push({ x: t, y: humi });\n    if (co2 !== null) outC.push({ x: t, y: co2 });\n}\n\n// 시간순 정렬 및 포인트 최적화\nconst tFinal = capAndDownsample(sortByTimestamp(outT), MAX_POINTS);\nconst hFinal = capAndDownsample(sortByTimestamp(outH), MAX_POINTS);\nconst cFinal = capAndDownsample(sortByTimestamp(outC), MAX_POINTS);\n\n/**\n * 중요: 데이터를 [ [Array], [Array], [Array] ] 형태로 반환하지 않고\n * 각 출력 포트(Output)마다 하나의 메세지 객체에 배열을 담아서 보냅니다.\n * 그래야 차트가 기존 데이터를 \"덧씌우지 않고\" 완전히 \"새로고침\"합니다.\n */\nreturn [\n    { payload: [{ series: [\"Temperature\"], data: [tFinal], labels: [\"Temperature\"] }] },\n    { payload: [{ series: [\"Humidity\"], data: [hFinal], labels: [\"Humidity\"] }] },\n    { payload: [{ series: [\"CO2\"], data: [cFinal], labels: [\"CO2\"] }] }\n];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 840,
        "y": 680,
        "wires": [
            [
                "61d28f90c35a0e04"
            ],
            [
                "c3284b9db2edcac0"
            ],
            [
                "b4b069056ce7fe97"
            ]
        ]
    },
    {
        "id": "e7fd9e961e86b1b1",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Temperature",
        "group": "c888f82b8cc4653a",
        "order": 4,
        "width": 6,
        "height": 5,
        "label": "Temperature (°C)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 7,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1290,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "9d672b31c0fdbdf0",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Humidity",
        "group": "c888f82b8cc4653a",
        "order": 5,
        "width": 6,
        "height": 5,
        "label": "Humidity (%)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "20",
        "ymax": "90",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": "",
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1300,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "74989654888b2172",
        "type": "ui_chart",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "CO2",
        "group": "c888f82b8cc4653a",
        "order": 6,
        "width": 6,
        "height": 5,
        "label": "CO2 (ppm)",
        "chartType": "line",
        "legend": "false",
        "xformat": "MM/DD HH:mm",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "300",
        "ymax": "",
        "removeOlder": "7",
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": "",
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000",
            "#000000"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1290,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "fc506592c792073d",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Filter last 7 days + build chart points",
        "func": "// Build UI chart points safely (limit + downsample)\n// Input: msg.payload = array of rows from SQLite\n// Columns expected: Date, EC, pH, Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\n// === Config ===\nconst DAYS = 7;\nconst MAX_POINTS = 500;        // Limit data points to keep UI responsive\nconst DEBUG_LOG = false;\n\nconst now = Date.now();\nconst cutoff = now - DAYS * 24 * 60 * 60 * 1000;\n\n// --- Helpers ---\nfunction toMs(dateStr) {\n  if (!dateStr) return null;\n\n  const s = String(dateStr).trim();\n\n  /* TIMEZONE FIX:\n     JavaScript treats \"YYYY-MM-DDTHH:mm\" as UTC.\n     Replacing \"-\" with \"/\" and avoiding \"T\" forces the parser \n     to interpret the string as LOCAL TIME.\n  */\n  const localFormat = s.replace(/-/g, \"/\");\n  const t = new Date(localFormat).getTime();\n\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n  if (v === null || v === undefined) return null;\n  if (typeof v === \"number\") return Number.isFinite(v) ? v : null;\n  const s = String(v).trim();\n  if (!s.length) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n  arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n  return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  const step = Math.ceil(arr.length / maxPoints);\n  const out = [];\n  for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n  return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  // Extract a larger tail before downsampling to ensure smooth recent trends\n  const tail = arr.slice(-maxPoints * 4);\n  return downsampleEvenly(tail, maxPoints);\n}\n\n// --- Build Data Series ---\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor (const r of rows) {\n  const t = toMs(r.Date);\n\n  // Redundant filter in case SQL query returns broader range\n  if (t === null || t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if (ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if (ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if (tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Sort and downsample to maintain dashboard performance\nsortByTimestamp(outEC);\nsortByTimestamp(outPH);\nsortByTimestamp(outTP);\n\nconst ecFinal = capAndDownsample(outEC, MAX_POINTS);\nconst phFinal = capAndDownsample(outPH, MAX_POINTS);\nconst tpFinal = capAndDownsample(outTP, MAX_POINTS);\n\n// Return 3 separate outputs for EC, pH, and Temperature charts\nreturn [ecFinal, phFinal, tpFinal];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 160,
        "wires": [
            [
                "2b11787c0f4b97a0"
            ],
            [
                "fcc61e3763443285"
            ],
            [
                "9e58a61289d8c37b"
            ]
        ]
    },
    {
        "id": "66dddb17279fa4ea",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Filter last 7 days + build chart points",
        "func": "// Build UI chart points safely (limit + downsample)\n// Input: msg.payload = array of rows from SQLite\n// Columns expected: Date, EC, pH, Solution_Temperature\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n\n// === Config ===\nconst DAYS = 7;\nconst MAX_POINTS = 500;        // Limit data points to keep UI responsive\nconst DEBUG_LOG = false;\n\nconst now = Date.now();\nconst cutoff = now - DAYS * 24 * 60 * 60 * 1000;\n\n// --- Helpers ---\nfunction toMs(dateStr) {\n  if (!dateStr) return null;\n\n  const s = String(dateStr).trim();\n\n  /* TIMEZONE FIX:\n     JavaScript treats \"YYYY-MM-DDTHH:mm\" as UTC.\n     Replacing \"-\" with \"/\" and avoiding \"T\" forces the parser \n     to interpret the string as LOCAL TIME.\n  */\n  const localFormat = s.replace(/-/g, \"/\");\n  const t = new Date(localFormat).getTime();\n\n  return Number.isFinite(t) ? t : null;\n}\n\nfunction toNum(v) {\n  if (v === null || v === undefined) return null;\n  if (typeof v === \"number\") return Number.isFinite(v) ? v : null;\n  const s = String(v).trim();\n  if (!s.length) return null;\n  const n = Number(s);\n  return Number.isFinite(n) ? n : null;\n}\n\nfunction sortByTimestamp(arr) {\n  arr.sort((a, b) => (a.timestamp || 0) - (b.timestamp || 0));\n  return arr;\n}\n\nfunction downsampleEvenly(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  const step = Math.ceil(arr.length / maxPoints);\n  const out = [];\n  for (let i = 0; i < arr.length; i += step) out.push(arr[i]);\n  return out;\n}\n\nfunction capAndDownsample(arr, maxPoints) {\n  if (arr.length <= maxPoints) return arr;\n  // Extract a larger tail before downsampling to ensure smooth recent trends\n  const tail = arr.slice(-maxPoints * 4);\n  return downsampleEvenly(tail, maxPoints);\n}\n\n// --- Build Data Series ---\nconst outEC = [];\nconst outPH = [];\nconst outTP = [];\n\nfor (const r of rows) {\n  const t = toMs(r.Date);\n\n  // Redundant filter in case SQL query returns broader range\n  if (t === null || t < cutoff) continue;\n\n  const ec = toNum(r.EC);\n  const ph = toNum(r.pH);\n  const tp = toNum(r.Solution_Temperature);\n\n  if (ec !== null) outEC.push({ payload: ec, timestamp: t, topic: \"EC\" });\n  if (ph !== null) outPH.push({ payload: ph, timestamp: t, topic: \"pH\" });\n  if (tp !== null) outTP.push({ payload: tp, timestamp: t, topic: \"Solution_Temperature\" });\n}\n\n// Sort and downsample to maintain dashboard performance\nsortByTimestamp(outEC);\nsortByTimestamp(outPH);\nsortByTimestamp(outTP);\n\nconst ecFinal = capAndDownsample(outEC, MAX_POINTS);\nconst phFinal = capAndDownsample(outPH, MAX_POINTS);\nconst tpFinal = capAndDownsample(outTP, MAX_POINTS);\n\n// Return 3 separate outputs for EC, pH, and Temperature charts\nreturn [ecFinal, phFinal, tpFinal];",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 440,
        "wires": [
            [
                "2ca82c801cc78dcf"
            ],
            [
                "7bcaa443ae916920"
            ],
            [
                "c17e5970c5cc707c"
            ]
        ]
    },
    {
        "id": "2b11787c0f4b97a0",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1100,
        "y": 100,
        "wires": [
            [
                "2c1d3e4f5a6b7c80"
            ]
        ]
    },
    {
        "id": "fcc61e3763443285",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1100,
        "y": 160,
        "wires": [
            [
                "3d2e4f5a6b7c8d90"
            ]
        ]
    },
    {
        "id": "9e58a61289d8c37b",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 220,
        "wires": [
            [
                "4e3f5a6b7c8d9ea0"
            ]
        ]
    },
    {
        "id": "2ca82c801cc78dcf",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 380,
        "wires": [
            [
                "84915ae7f5c9b3c6"
            ]
        ]
    },
    {
        "id": "7bcaa443ae916920",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 440,
        "wires": [
            [
                "7b2f5b8520aa74d8"
            ]
        ]
    },
    {
        "id": "c17e5970c5cc707c",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "10",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1060,
        "y": 480,
        "wires": [
            [
                "6104d3b154bae62a"
            ]
        ]
    },
    {
        "id": "61d28f90c35a0e04",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 640,
        "wires": [
            [
                "e7fd9e961e86b1b1"
            ]
        ]
    },
    {
        "id": "c3284b9db2edcac0",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 680,
        "wires": [
            [
                "9d672b31c0fdbdf0"
            ]
        ]
    },
    {
        "id": "b4b069056ce7fe97",
        "type": "delay",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "100",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1080,
        "y": 740,
        "wires": [
            [
                "74989654888b2172"
            ]
        ]
    },
    {
        "id": "b5943a1f7cf1632b",
        "type": "sqlite",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "mydb": "8a2dbce163db26b4",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "Dist 1 EC pH sqlite",
        "x": 510,
        "y": 120,
        "wires": [
            [
                "fc506592c792073d"
            ]
        ]
    },
    {
        "id": "8d576cf243516148",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "be6e98c17615581b",
        "name": "Build SQL",
        "func": "// Build SQL for SQLite node (Dist_1_EC_pH_log)\n// Output: msg.topic = SQL, msg._meta = settings\n\nconst DAYS = 7;\nconst LIMIT_ROWS = 700; // 보험 (20분 저장이면 504행 정도라 사실상 영향 없음)\n\nmsg.topic = `\nSELECT Date, EC, pH, Solution_Temperature\nFROM Dist_1_EC_pH_log\nWHERE Date >= datetime('now','localtime','-${DAYS} days')\nORDER BY Date ASC\nLIMIT ${LIMIT_ROWS};\n`;\n\nmsg._meta = { days: DAYS, limit: LIMIT_ROWS, source: \"sqlite\" };\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 120,
        "wires": [
            [
                "b5943a1f7cf1632b"
            ]
        ]
    },
    {
        "id": "6b044a38741310f6",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "name": "Build SQL",
        "func": "const DAYS = 7;\nconst LIMIT_ROWS = 700;\n\nmsg.topic =\n    \"SELECT Date, EC, pH, Solution_Temperature, \" +\n    \"CAST(strftime('%s', Date) AS INTEGER) * 1000 AS ts \" +\n    \"FROM Dist_2_EC_pH_log \" +\n    `WHERE Date >= datetime('now','localtime','-${DAYS} days') ` +\n    \"ORDER BY Date ASC \" +\n    `LIMIT ${LIMIT_ROWS};`;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 380,
        "wires": [
            [
                "413edac3ab2c73bf"
            ]
        ]
    },
    {
        "id": "413edac3ab2c73bf",
        "type": "sqlite",
        "z": "c7d9c1b1f0a6a111",
        "g": "7e05584f07adae7b",
        "mydb": "8a2dbce163db26b4",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "Dist 2 EC pH sqlite",
        "x": 510,
        "y": 380,
        "wires": [
            [
                "66dddb17279fa4ea"
            ]
        ]
    },
    {
        "id": "e9bba788651eb3d4",
        "type": "function",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "name": "Build SQL",
        "func": "const DAYS = 7;\nconst LIMIT_ROWS = 800;\n\nmsg.topic =\n    \"SELECT Date, Temperature, Humidity, CO2, \" +\n    \"CAST(strftime('%s', Date) AS INTEGER) * 1000 AS ts \" +\n    \"FROM Temp_humi_log \" +\n    `WHERE CAST(strftime('%s', Date) AS INTEGER) >= CAST(strftime('%s','now','localtime','-${DAYS} days') AS INTEGER) ` +\n    \"ORDER BY ts ASC \" +\n    `LIMIT ${LIMIT_ROWS};`;\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 320,
        "y": 680,
        "wires": [
            [
                "715c885393e8b131"
            ]
        ]
    },
    {
        "id": "715c885393e8b131",
        "type": "sqlite",
        "z": "c7d9c1b1f0a6a111",
        "g": "89c2f9d79f818571",
        "mydb": "8a2dbce163db26b4",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "Room condition sqlite",
        "x": 520,
        "y": 680,
        "wires": [
            [
                "efb0d37433575254"
            ]
        ]
    },
    {
        "id": "adc9839917f22d12",
        "type": "inject",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Auto Refresh",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 12 * * *",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 220,
        "y": 160,
        "wires": [
            [
                "197112b240ad2134",
                "d4739939fd8e23db"
            ]
        ]
    },
    {
        "id": "944e216c6a520e54",
        "type": "ui_button",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Manual Refresh",
        "group": "ui_grp_table",
        "order": 7,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Data Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 220,
        "y": 220,
        "wires": [
            [
                "197112b240ad2134"
            ]
        ]
    },
    {
        "id": "a22b223becb16273",
        "type": "ui_template",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "group": "ui_grp_table",
        "name": "Download CSV Button",
        "order": 6,
        "width": 6,
        "height": 2,
        "format": "<div style=\"display:flex; gap:8px; flex-direction:column;\">\n  <a class=\"md-button md-raised md-primary\"\n     style=\"width:100%;display:flex;align-items:center;justify-content:center;\"\n     ng-href=\"/download_csv?table={{msg.table}}&start={{msg.start}}&end={{msg.end}}\"\n     target=\"_self\">\n    CSV Download\n  </a>\n  <div style=\"font-size:12px; opacity:0.7;\">\n    {{msg.table}} / {{msg.start}} ~ {{msg.end}}\n  </div>\n</div>",
        "storeOutMessages": false,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 820,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "197112b240ad2134",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Build SQL (latest 200)",
        "func": "// Build SQL to show latest rows in ui_table.\n// You can change TIME_COL if your schema uses a different column name.\n\nconst table = flow.get('dl_table') || 'Temp_humi_log';\n\nconst ALLOWED = new Set([\n  'Temp_humi_log',\n  'Dist_1_EC_pH_log',\n  'Dist_1_Solution_input_log',\n  'Dist_2_EC_pH_log',\n  'Dist_2_Solution_input_log'\n]);\nif(!ALLOWED.has(table)) {\n  msg.payload = [];\n  return msg;\n}\n\nconst TIME_COL = {\n  'Temp_humi_log': 'Date',\n  'Dist_1_EC_pH_log': 'Date',\n  'Dist_1_Solution_input_log': 'timestamp',\n  'Dist_2_EC_pH_log': 'Date',\n  'Dist_2_Solution_input_log': 'Date'\n};\n\nconst timeCol = TIME_COL[table];\nmsg.topic = `SELECT * FROM ${table} ORDER BY ${timeCol} DESC LIMIT 200`;\nmsg._table = table;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 180,
        "wires": [
            [
                "10b47748db311969"
            ]
        ]
    },
    {
        "id": "2588aa26c880e550",
        "type": "ui_table",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "group": "ui_grp_table",
        "name": "Table",
        "order": 4,
        "width": 12,
        "height": 8,
        "columns": [],
        "outputs": 1,
        "cts": true,
        "x": 1150,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "90d2176c35e8e7cb",
        "type": "http in",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "GET /download_csv",
        "url": "/download_csv",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 230,
        "y": 480,
        "wires": [
            [
                "b125209d3d41004e"
            ]
        ]
    },
    {
        "id": "a0eaac3edf8af92e",
        "type": "http response",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Send CSV",
        "statusCode": "",
        "headers": {},
        "x": 1150,
        "y": 480,
        "wires": []
    },
    {
        "id": "96aa85f9b22bce2a",
        "type": "comment",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "(W) Read from SQLite DB, show latest rows, and download CSV by date range",
        "info": "",
        "x": 390,
        "y": 100,
        "wires": []
    },
    {
        "id": "14035e35d8173d54",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "CSV → rows[] (unused)",
        "func": "// This node is kept for compatibility but no longer used.\n// Previously used for CSV file parsing.\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 750,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "10b47748db311969",
        "type": "sqlite",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "mydb": "sql_db_cfg",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "SQLite (latest)",
        "x": 760,
        "y": 180,
        "wires": [
            [
                "1d859b1f08e16750"
            ]
        ]
    },
    {
        "id": "1d859b1f08e16750",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Rows → ui_table payload",
        "func": "// Prepare rows for ui_table.\n// ui_table expects msg.payload to be an array of objects.\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\n// Reverse to chronological order (oldest → newest) if you prefer.\nrows.reverse();\nmsg.payload = rows;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 180,
        "wires": [
            [
                "2588aa26c880e550"
            ]
        ]
    },
    {
        "id": "5492ffead4d707b1",
        "type": "ui_dropdown",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Select Table",
        "label": "Table",
        "tooltip": "",
        "place": "select",
        "group": "ui_grp_table",
        "order": 1,
        "width": 4,
        "height": 1,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "Temp_humi_log",
                "value": "Temp_humi_log",
                "type": "str"
            },
            {
                "label": "Dist_1_EC_pH_log",
                "value": "Dist_1_EC_pH_log",
                "type": "str"
            },
            {
                "label": "Dist_1_Solution_input_log",
                "value": "Dist_1_Solution_input_log",
                "type": "str"
            },
            {
                "label": "Dist_2_EC_pH_log",
                "value": "Dist_2_EC_pH_log",
                "type": "str"
            },
            {
                "label": "Dist_2_Solution_input_log",
                "value": "Dist_2_Solution_input_log",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 210,
        "y": 260,
        "wires": [
            [
                "ad92971d35a3f9b1",
                "197112b240ad2134"
            ]
        ]
    },
    {
        "id": "5d24488e666ee37c",
        "type": "ui_date_picker",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Start Date",
        "label": "Start",
        "group": "ui_grp_table",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": true,
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 210,
        "y": 320,
        "wires": [
            [
                "6db4030be30fbdb9"
            ]
        ]
    },
    {
        "id": "9a6aa10181469ac7",
        "type": "ui_date_picker",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "End Date",
        "label": "End",
        "group": "ui_grp_table",
        "order": 3,
        "width": 4,
        "height": 1,
        "passthru": true,
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 200,
        "y": 360,
        "wires": [
            [
                "716fa25ba9db853a"
            ]
        ]
    },
    {
        "id": "ad92971d35a3f9b1",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Store table (flow)",
        "func": "// Save selected table into flow context.\nconst v = (msg.payload || 'Temp_humi_log').toString();\nflow.set('dl_table', v);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "6db4030be30fbdb9",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Store start (flow)",
        "func": "// Save start date (YYYY-MM-DD) into flow context.\n// ui_date_picker usually outputs a Date object or timestamp; normalize to YYYY-MM-DD.\nlet d = msg.payload;\nlet dt;\nif (typeof d === 'number') dt = new Date(d);\nelse if (d instanceof Date) dt = d;\nelse dt = new Date(d);\nconst yyyy = dt.getFullYear();\nconst mm = String(dt.getMonth() + 1).padStart(2,'0');\nconst dd = String(dt.getDate()).padStart(2,'0');\nflow.set('dl_start', `${yyyy}-${mm}-${dd}`);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "716fa25ba9db853a",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Store end (flow)",
        "func": "// Save end date (YYYY-MM-DD) into flow context.\nlet d = msg.payload;\nlet dt;\nif (typeof d === 'number') dt = new Date(d);\nelse if (d instanceof Date) dt = d;\nelse dt = new Date(d);\nconst yyyy = dt.getFullYear();\nconst mm = String(dt.getMonth() + 1).padStart(2,'0');\nconst dd = String(dt.getDate()).padStart(2,'0');\nflow.set('dl_end', `${yyyy}-${mm}-${dd}`);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "cae69a4b087570ee",
        "type": "ui_button",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Apply Range",
        "group": "ui_grp_table",
        "order": 5,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "Apply (Update Download Link)",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "check",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 270,
        "y": 400,
        "wires": [
            [
                "d4739939fd8e23db"
            ]
        ]
    },
    {
        "id": "d4739939fd8e23db",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Apply → template msg",
        "func": "function fmtDate(d) {\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, '0');\n  const dd = String(d.getDate()).padStart(2, '0');\n  return `${yyyy}-${mm}-${dd}`;\n}\n\nconst table = flow.get('dl_table') || 'Temp_humi_log';\nlet start = flow.get('dl_start');\nlet end = flow.get('dl_end');\n\nconst today = new Date();\nif (!end) {\n  end = fmtDate(today);\n  flow.set('dl_end', end);\n}\nif (!start) {\n  const d = new Date();\n  d.setDate(today.getDate() - 7);\n  start = fmtDate(d);\n  flow.set('dl_start', start);\n}\n\nmsg.table = table;\nmsg.start = start;\nmsg.end = end;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 400,
        "wires": [
            [
                "a22b223becb16273"
            ]
        ]
    },
    {
        "id": "b125209d3d41004e",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Build SQL (range)",
        "func": "// Build SQL for CSV download WITHOUT placeholders (avoid sqlite param binding issues)\n// Time columns are TEXT and sortable as strings if formatted like YYYY-MM-DD HH:MM(:SS)\n\nconst q = (msg.req && msg.req.query) ? msg.req.query : {};\nconst table = (q.table || 'Temp_humi_log').toString();\nconst start = (q.start || '').toString();\nconst end = (q.end || '').toString();\n\nconst ALLOWED = new Set([\n  'Temp_humi_log',\n  'Dist_1_EC_pH_log',\n  'Dist_1_Solution_input_log',\n  'Dist_2_EC_pH_log',\n  'Dist_2_Solution_input_log'\n]);\n\nif (!ALLOWED.has(table)) {\n  msg.statusCode = 400;\n  msg.payload = 'Invalid table';\n  return [null, msg];\n}\n\nconst COLUMN_MAP = {\n  'Temp_humi_log': 'Date',                 // text: YYYY-MM-DD HH:MM\n  'Dist_1_EC_pH_log': 'Date',\n  'Dist_2_EC_pH_log': 'Date',\n  'Dist_2_Solution_input_log': 'Date',\n  'Dist_1_Solution_input_log': 'timestamp' // text\n};\n\nconst timeCol = COLUMN_MAP[table];\nif (!timeCol) {\n  msg.statusCode = 400;\n  msg.payload = 'Invalid table mapping';\n  return [null, msg];\n}\n\n// Normalize to minute/second precision depending on column name\nfunction normForDateCol(s, isEnd) {\n  if (!s) return null;\n  const t = s.replace('T', ' ').trim();\n  if (t.length === 10) return isEnd ? `${t} 23:59` : `${t} 00:00`;\n  if (t.length >= 16) return t.slice(0, 16);   // YYYY-MM-DD HH:MM\n  return t;\n}\nfunction normForTimestampCol(s, isEnd) {\n  if (!s) return null;\n  const t = s.replace('T', ' ').trim();\n  if (t.length === 10) return isEnd ? `${t} 23:59:59` : `${t} 00:00:00`;\n  if (t.length === 16) return isEnd ? `${t}:59` : `${t}:00`; // add seconds\n  if (t.length >= 19) return t.slice(0, 19);   // YYYY-MM-DD HH:MM:SS\n  return t;\n}\n\nlet startRange, endRange;\nif (timeCol === 'Date') {\n  startRange = normForDateCol(start, false);\n  endRange = normForDateCol(end, true);\n} else {\n  startRange = normForTimestampCol(start, false);\n  endRange = normForTimestampCol(end, true);\n}\n\nif (!startRange || !endRange) {\n  msg.statusCode = 400;\n  msg.payload = 'Missing start/end';\n  return [null, msg];\n}\n\n// Validate format to prevent injection (allow \"YYYY-MM-DD HH:MM\" or \"YYYY-MM-DD HH:MM:SS\")\nconst re = /^\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}(:\\d{2})?$/;\nif (!re.test(startRange) || !re.test(endRange)) {\n  msg.statusCode = 400;\n  msg.payload = 'Invalid date format';\n  return [null, msg];\n}\n\n// Escape quotes just in case (shouldn't occur after regex, but keep safe)\nconst sEsc = startRange.replace(/'/g, \"''\");\nconst eEsc = endRange.replace(/'/g, \"''\");\n\nmsg.topic = `SELECT * FROM \"${table}\" WHERE \"${timeCol}\" >= '${sEsc}' AND \"${timeCol}\" <= '${eEsc}' ORDER BY \"${timeCol}\" ASC`;\nmsg._dl = { table, start: startRange, end: endRange };\n\nreturn [msg, null];\n",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 480,
        "wires": [
            [
                "f5a6a15636c2ae8a"
            ],
            [
                "a0eaac3edf8af92e"
            ]
        ]
    },
    {
        "id": "f5a6a15636c2ae8a",
        "type": "sqlite",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "mydb": "sql_db_cfg",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "SQLite (range)",
        "x": 700,
        "y": 440,
        "wires": [
            [
                "7dc725beeaba75fc"
            ]
        ]
    },
    {
        "id": "7dc725beeaba75fc",
        "type": "function",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "name": "Rows → CSV (buffer)",
        "func": "// Convert sqlite rows to CSV and return as binary buffer.\n\nconst rows = Array.isArray(msg.payload) ? msg.payload : [];\nconst meta = msg._dl || { table: 'export', start: '', end: '' };\n\nfunction esc(v){\n  if(v === null || v === undefined) return '';\n  const s = String(v);\n  if (/[,\"\\n\\r]/.test(s)) return '\"' + s.replace(/\"/g,'\"\"') + '\"';\n  return s;\n}\n\nlet csv = '';\nif(rows.length === 0){\n  csv = 'no_data\\n';\n} else {\n  const headers = Object.keys(rows[0]);\n  csv += headers.join(',') + '\\n';\n  for(const r of rows){\n    csv += headers.map(h => esc(r[h])).join(',') + '\\n';\n  }\n}\n\n// Excel-friendly BOM\nconst bom = '\\uFEFF';\nconst buf = Buffer.from(bom + csv, 'utf8');\n\nconst safeName = `${meta.table}_${meta.start.replace(/[: ]/g,'-')}_to_${meta.end.replace(/[: ]/g,'-')}.csv`;\n\nmsg.payload = buf;\nmsg.headers = {\n  'Content-Type': 'text/csv; charset=utf-8',\n  'Content-Disposition': `attachment; filename=${safeName}`\n};\nmsg.statusCode = 200;\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 940,
        "y": 440,
        "wires": [
            [
                "a0eaac3edf8af92e"
            ]
        ]
    },
    {
        "id": "6897d08c634f30b3",
        "type": "ui_template",
        "z": "flow_all",
        "g": "8446b5ed352ca2d8",
        "group": "ui_grp_table",
        "name": "",
        "order": 8,
        "width": 12,
        "height": 1,
        "format": "<style>\n    /* Force visibility of DatePicker header */\n    .md-datepicker-calendar-pane {\n        background-color: #ffffff !important; /* White background for visibility */\n        border: 1px solid #ccc;\n    }\n    .md-datepicker-calendar-header, \n    .md-calendar-day-header,\n    .md-calendar-month-year-selector {\n        background-color: #009688 !important; /* Teal color */\n        color: white !important;\n    }\n    /* Fix for year display (252025 bug) often related to CSS scaling */\n    .v-date-picker-title__date {\n        font-size: 20px !important;\n        line-height: 1.2 !important;\n    }\n    /* Ensure year selector text is visible */\n    md-calendar-month-year-selector .md-calendar-month-year-button {\n        color: white !important;\n        background: transparent !important;\n    }\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 700,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "inj_start_6",
        "type": "inject",
        "z": "tab_mjpg_sched",
        "name": "매일 06:00 START",
        "props": [],
        "repeat": "",
        "crontab": "00 06 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 220,
        "wires": [
            [
                "exec_start"
            ]
        ]
    },
    {
        "id": "exec_start",
        "type": "exec",
        "z": "tab_mjpg_sched",
        "command": "bash -lc 'cd /home/cja/mjpg-streamer/mjpg-streamer-experimental && export LD_LIBRARY_PATH=. && ./mjpg_streamer -i \"./input_uvc.so -d /dev/video0 -r 1280x720 -f 5\" -o \"./output_http.so -p 8080 -w ./www\" >/tmp/mjpg.log 2>&1 &'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "start mjpg-streamer",
        "x": 370,
        "y": 220,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "inj_stop_1",
        "type": "inject",
        "z": "tab_mjpg_sched",
        "d": true,
        "name": "매일 04:00 STOP",
        "props": [],
        "repeat": "",
        "crontab": "00 04 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 150,
        "y": 120,
        "wires": [
            [
                "exec_stop"
            ]
        ]
    },
    {
        "id": "exec_stop",
        "type": "exec",
        "z": "tab_mjpg_sched",
        "d": true,
        "command": "bash -lc 'pgrep mjpg_streamer >/dev/null && pkill -f mjpg_streamer || true'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "kill mjpg-streamer",
        "x": 370,
        "y": 120,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "7eb5ace1daebe4df",
        "type": "inject",
        "z": "tab_mjpg_sched",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 280,
        "wires": [
            [
                "exec_start"
            ]
        ]
    }
]